{"id":"opencode-squads-04h","title":"Events UI: timeline view for agent/session + real dashboard activity","description":"Problem\n- We invested in an Events model + SSE invalidation, but there's no real UI for browsing events. The dashboard \"Recent_Activity\" is currently static placeholder content.\n\nWork\n- Add an events timeline UI that can be filtered by project, agent, or session.\n- Reuse existing /api/events endpoint (supports project_id/session_id/agent_id).\n- Update dashboard \"Recent_Activity\" to use real events for the active project (or add a dedicated /events page linked from nav).\n- In agent/session context, show a compact timeline panel (optional tab).\n\nNotes\n- Event kinds are currently stored as kind + payload JSON; UI should render kind as title and payload as collapsible JSON.\n","acceptance_criteria":"- I can view a list of recent events for the active project in the UI.\n- I can filter events by agent or session and see them update.\n- Events render with time, kind, and payload (payload readable/collapsible).\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-02T10:09:11.866107+01:00","updated_at":"2026-01-02T16:58:28.459978+01:00","closed_at":"2026-01-02T16:58:28.459978+01:00","labels":["events","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-04h","depends_on_id":"opencode-squads-v3q","type":"discovered-from","created_at":"2026-01-02T10:09:11.867768+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-09p","title":"Mail threads list doesn't update after send","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T17:05:02.827582+01:00","updated_at":"2026-01-05T09:07:54.19103+01:00","closed_at":"2026-01-05T09:07:54.19103+01:00"}
{"id":"opencode-squads-0cv","title":"Play button/history selection starting new sessions or entering read-only immediately","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T14:36:46.817734+01:00","updated_at":"2026-01-02T14:37:46.163931+01:00","closed_at":"2026-01-02T14:37:46.163931+01:00"}
{"id":"opencode-squads-0h8","title":"Mail UI send button doesn't send email","description":"Pressing the send button in the mail UI does nothing - the email is not sent. Need to investigate the frontend handler and backend endpoint.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-01T12:21:47.344667+01:00","updated_at":"2026-01-01T12:25:57.16607+01:00","closed_at":"2026-01-01T12:25:57.16607+01:00"}
{"id":"opencode-squads-0i6","title":"Web client: /new command + command palette action","description":"Problem\n- Creating a new session is currently buried behind per-agent buttons and not accessible via a consistent command pattern.\n\nWork\n- Add a \"New Session\" action in the global command palette that is context-aware (uses the currently selected agent/session if available).\n- Add /new handling in the chat composer: typing /new triggers the new-session flow instead of sending as a normal prompt.\n- Use the backend \"new session for agent\" endpoint for atomic behavior.\n- After success, navigate/switch UI context to the newly started session.\n\nNotes\n- /new should stop the prior session (keep OpenCode server running) and record termination provenance via metadata.terminated_by=\"user\".\n","design":"UX considerations\n- Confirm dialog when stopping an active session (matching existing terminate flow).\n- In read-only historical sessions, /new should still be allowed (it starts a new session, not the historical one).\n- Consider showing a toast with the new session id and a link to switch.\n","acceptance_criteria":"- I can trigger New Session from the command palette while viewing an agent/session and it starts a new session for that agent.\n- I can type /new in the session chat input and it starts a new session for that agent.\n- UI switches focus to the new session automatically and updates session lists via query invalidation/SSE.\n- The old session remains visible in history and shows termination provenance (terminated_by=user).\n","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-02T10:08:21.413093+01:00","updated_at":"2026-01-02T15:23:11.490904+01:00","closed_at":"2026-01-02T15:23:11.490904+01:00","labels":["frontend","sessions","ux"],"dependencies":[{"issue_id":"opencode-squads-0i6","depends_on_id":"opencode-squads-v3q","type":"blocks","created_at":"2026-01-02T10:08:21.41476+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-0kd","title":"Remove placeholder and no-op comments in API and telemetry modules","description":"Problem:\n- Several files contain placeholder or for now comments that do not add meaning and can become stale.\n- This adds noise and hides the real intent.\n\nExamples:\n- lib/squads_web/controllers/api/mcp_controller.ex (placeholder comments)\n- lib/squads_web/telemetry.ex (generated template comments)\n- lib/squads_web/controllers/api/mail_json.ex (unread_count placeholder)\n- lib/squads/tickets.ex (worktree cleanup debate comment)\n- lib/squads/beads/adapter.ex (for now or optional init comments)\n\nTask:\n- Remove placeholder or no-op comments, or replace with concise, useful documentation.\n- If future work is needed, open separate bd issues instead of leaving TODOs.","acceptance_criteria":"- No placeholder or for now comments remain in the above files.\n- Remaining comments are concise and add clear value.","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-01T20:57:07.25364+01:00","updated_at":"2026-01-02T09:01:22.293746+01:00","closed_at":"2026-01-02T09:01:22.293746+01:00"}
{"id":"opencode-squads-0qc","title":"Move agent/squad controller helpers into contexts","description":"Problem:\n- SquadController and AgentController contain helper logic (with_project/with_squad, preload_agents, and branching create logic for auto vs explicit agent names).\n- This blends domain concerns into the web layer and makes reuse harder.\n\nProposal:\n- Add context helpers such as Squads.list_squads_with_agents/1 and Squads.get_squad_with_agents/1.\n- Add Agents.create_agent_for_squad/2 to encapsulate auto-name vs explicit name/slug creation.\n\nAcceptance:\n- Controllers delegate to context functions and remove local helper branches.\n- Business rules are centralized in Squads and Agents contexts.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T21:54:24.608641+01:00","updated_at":"2025-12-31T22:17:03.87053+01:00","closed_at":"2025-12-31T22:17:03.87053+01:00"}
{"id":"opencode-squads-15f","title":"Implement Squads Page Empty State","description":"","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T20:50:51.330593+01:00","updated_at":"2026-01-01T20:56:51.530814+01:00","closed_at":"2026-01-01T20:56:51.530814+01:00"}
{"id":"opencode-squads-1wc","title":"API: connect/disconnect squads (fleet)","description":"Work\n- Add API endpoints to manage squad connections globally:\n  - list connections\n  - create connection\n  - remove/disable connection\n- Enforce basic validation (squad exists, not self-connecting, dedupe).\n- Emit events for connect/disconnect.\n\nAPI sketch\n- GET /api/fleet/connections\n- POST /api/fleet/connections { from_squad_id, to_squad_id }\n- DELETE /api/fleet/connections/:id\n","acceptance_criteria":"- Connections can be created and removed via API.\n- Duplicate connections are rejected or idempotent.\n- Events are emitted so clients can update without refresh.\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-02T10:12:21.013693+01:00","updated_at":"2026-01-02T17:33:58.951028+01:00","closed_at":"2026-01-02T17:33:58.951032+01:00","labels":["api","backend","fleet"],"dependencies":[{"issue_id":"opencode-squads-1wc","depends_on_id":"opencode-squads-5b0","type":"blocks","created_at":"2026-01-02T10:12:21.015105+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-1yx","title":"Make OpenCode.Server startup non-blocking and supervised","description":"Problem:\n- Squads.OpenCode.Server.handle_call/3 calls start_project_server/2 and wait_for_healthy/2 inside the GenServer.\n- wait_for_healthy/2 can sleep up to 60 seconds, blocking the server process.\n\nWhy it matters:\n- Other callers to ensure_running/2 or list_running_servers/0 can time out.\n- Concurrent project startups can stall the supervisor tree.\n\nContext:\n- lib/squads/opencode/server.ex (handle_call, start_project_server, wait_for_healthy).","design":"Approach:\n- Move process start and health check into a supervised worker (Task.Supervisor or DynamicSupervisor).\n- Track per-project state (starting/running/failed) and coalesce concurrent callers.\n- Use GenServer.reply to wake waiting callers when startup completes.\n- Keep Registry updates and :EXIT cleanup behavior.","acceptance_criteria":"- ensure_running/2 does not block the GenServer while a project is starting.\n- Concurrent ensure_running/2 calls for the same project start only one process and return the same URL.\n- Startup failure returns a clear error and cleans state and registry.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T20:56:46.637181+01:00","updated_at":"2026-01-02T08:25:31.926428+01:00","closed_at":"2026-01-02T08:25:31.926428+01:00"}
{"id":"opencode-squads-1zc","title":"Mail API options ignored due to string keys","description":"MailController.index passes params map with string keys to Mail.list_inbox, which reads atom keys (lib/squads/mail.ex:17). limit/urgent_only/since_ts are ignored. MailController.reply passes params to reply_to_message, so importance and ack_required overrides are ignored. Normalize params or accept string keys.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T17:56:19.448472+01:00","updated_at":"2025-12-31T19:18:49.238609+01:00","closed_at":"2025-12-31T19:18:49.238609+01:00"}
{"id":"opencode-squads-28g","title":"Enable stopping global sessions from Session view","description":"In the global Session view, users should be able to stop running sessions directly, similar to the functionality being added to the Squads view. This improves consistency and control over active sessions.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-02T08:34:01.727599+01:00","updated_at":"2026-01-02T08:37:12.529922+01:00","closed_at":"2026-01-02T08:37:12.529922+01:00"}
{"id":"opencode-squads-2jj","title":"Trim defensive and no-op logic in EventIngester","description":"Problem:\n- EventIngester contains defensive or no-op logic that hides failures or adds dead code.\n- start_sse_stream/1 rescues all exceptions and returns {:error, e}, which can mask crashes.\n- persist_event/3 pre-checks kind against Squads.Events.Event.kinds(), but the changeset already validates this.\n- handle_info({:DOWN, ...}) is a no-op and no monitor is set.\n\nTask:\n- Remove or narrow the blanket rescue; decide if unexpected exceptions should crash and restart the process.\n- Remove the redundant kind pre-check or replace it with a warning while relying on changeset validation.\n- Either add a monitor with meaningful handling or remove the :DOWN clause.\n\nContext:\n- lib/squads/opencode/event_ingester.ex","acceptance_criteria":"- Error handling is intentional and visible (no blanket rescue for unexpected failures).\n- No dead :DOWN handler without a monitor.\n- Event kind validation lives in one place and behavior is clear.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T20:57:02.097721+01:00","updated_at":"2026-01-02T08:40:20.002588+01:00","closed_at":"2026-01-02T08:40:20.002588+01:00"}
{"id":"opencode-squads-33a","title":"Backend: FunctionClauseError in Squads.Sessions.map_opencode_status/1","description":"A FunctionClauseError occurs in Squads.Sessions.map_opencode_status/1 when the OpenCode session map is missing the 'status' key. This occurs when trying to send a message on a historic session during the Squads.Sessions.send_message/3 flow.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T16:52:55.866342+01:00","updated_at":"2026-01-02T16:55:52.139801+01:00","closed_at":"2026-01-02T16:55:52.139801+01:00"}
{"id":"opencode-squads-3if","title":"Implement MCP OAuth orchestration","description":"Reference: docs/prd-mcp-agents.md (Authorization and Secrets).\n\nAdd backend endpoints and context functions to initiate and track Docker MCP OAuth flows. Implement MCP.oauth_authorize/1 to call docker mcp oauth authorize \u003cprovider\u003e and store status per squad/server. Add MCP.oauth_list/0 for status checks and expose via API. Ensure errors are surfaced and logged without leaking tokens.","acceptance_criteria":"- New MCP context functions for oauth authorize and status.\n- API endpoints exist for OAuth init/status.\n- Errors handled with clear messages.\n- Tests stub DockerCLI oauth calls.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T22:39:03.8403+01:00","updated_at":"2026-01-02T22:39:03.8403+01:00"}
{"id":"opencode-squads-3r7","title":"Allow re-initializing projects that exist on disk but not in database","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T21:59:47.744811+01:00","updated_at":"2026-01-02T22:00:27.899046+01:00","closed_at":"2026-01-02T22:00:27.899046+01:00"}
{"id":"opencode-squads-3t8","title":"Fix file autocomplete (@ trigger)","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-02T12:06:08.734128+01:00","updated_at":"2026-01-02T16:57:32.887853+01:00","closed_at":"2026-01-02T16:57:32.887853+01:00","dependencies":[{"issue_id":"opencode-squads-3t8","depends_on_id":"opencode-squads-0i6","type":"discovered-from","created_at":"2026-01-02T12:06:08.735382+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-485","title":"UI: External Nodes (ronin) browser + attach","description":"Work\n- Add a UI surface to browse discovered external OpenCode nodes.\n- For each node: show base_url, health/version, project directory (if known), last_seen, discovery source.\n- Provide actions:\n  - Open node\n  - View sessions\n  - Open a session transcript/chat\n  - (Optional Phase 1) Add node by URL (manual)\n\nRouting\n- Prefer a dedicated route (eg /nodes) or a section under a future Fleet view.\n- Keep it accessible from the global command palette.\n\nNotes\n- External-live mode means we do not import these sessions into Squads DB; we operate via proxy endpoints.\n","acceptance_criteria":"- I can see a list of external nodes and whether they are healthy.\n- I can click a node and view its sessions.\n- I can open a session and see its transcript (and interact if session is active).\n- I can add a node by URL if auto-discovery is unavailable.\n","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-02T10:11:06.926272+01:00","updated_at":"2026-01-02T17:15:24.859451+01:00","closed_at":"2026-01-02T17:15:24.859451+01:00","labels":["discovery","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-485","depends_on_id":"opencode-squads-oz5","type":"blocks","created_at":"2026-01-02T10:11:06.928001+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-4j7","title":"Show typing indicator when agent message content is empty","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-01T13:20:30.703759+01:00","updated_at":"2026-01-01T13:21:40.75105+01:00","closed_at":"2026-01-01T13:21:40.75105+01:00"}
{"id":"opencode-squads-4jo","title":"Add MCP tests (context and controller)","description":"Reference: docs/prd-mcp-agents.md (Implementation Plan: Phase 5).\n\nAdd tests for MCP context and controller. Cover CRUD, enable and disable, status sync (stubbed DockerCLI), and catalog endpoint (stubbed HTTP). Place tests under test/squads and test/squads_web/controllers/api.","acceptance_criteria":"- Context tests cover CRUD and validation errors.\n- Controller tests cover endpoints and error cases.\n- DockerCLI calls are stubbed with no real Docker dependency.\n- Test suite passes.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T21:48:52.234639+01:00","updated_at":"2026-01-02T21:48:52.234639+01:00"}
{"id":"opencode-squads-4m4","title":"SessionChat: Autocomplete for /commands and @file references","description":"Problem: Typing /commands and referencing files is manual and error-prone. \\n\\nWork: \\n- Implement an autocomplete menu in SessionChat composer triggered by '/' (commands) or '@' (files).\\n- Commands should be a static list (initially) or fetched from backend if available.\\n- File autocomplete should use a 'file search' API or the existing browser logic to find files in the project.\\n- Selecting an item inserts it into the composer.\\n\\nAcceptance:\\n- Typing '/' shows a list of common session commands.\\n- Typing '@' shows a list of project files.\\n- Keyboard navigation (arrows + enter) works for selection.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-02T11:45:08.010342+01:00","updated_at":"2026-01-02T16:57:20.283401+01:00","closed_at":"2026-01-02T16:57:20.283401+01:00","dependencies":[{"issue_id":"opencode-squads-4m4","depends_on_id":"opencode-squads-sxz","type":"discovered-from","created_at":"2026-01-02T11:45:08.011881+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-52v","title":"Project \u0026 Squad management UI","description":"","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-31T19:41:31.573726+01:00","updated_at":"2025-12-31T20:03:31.090121+01:00","closed_at":"2025-12-31T20:03:31.090121+01:00"}
{"id":"opencode-squads-52v.10","title":"Redesign /squad route to show squads with nested agents","description":"Frontend: Fix /squad page to display squad groups with their member agents nested inside. Currently shows squads as flat 'members' list which is semantically wrong. Backend: May need endpoint to return squads with preloaded agents.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T19:42:08.344641+01:00","updated_at":"2025-12-31T20:02:39.302016+01:00","closed_at":"2025-12-31T20:02:39.302016+01:00","dependencies":[{"issue_id":"opencode-squads-52v.10","depends_on_id":"opencode-squads-52v","type":"parent-child","created_at":"2025-12-31T19:42:08.345185+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-52v.11","title":"Add Agent CRUD API endpoints","description":"Backend: Add AgentController with endpoints to create/update/delete agents within a squad. Agents require squad_id, name (AdjectiveNoun format), and slug.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T19:42:10.062677+01:00","updated_at":"2025-12-31T20:02:40.740234+01:00","closed_at":"2025-12-31T20:02:40.740234+01:00","dependencies":[{"issue_id":"opencode-squads-52v.11","depends_on_id":"opencode-squads-52v","type":"parent-child","created_at":"2025-12-31T19:42:10.063209+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-52v.12","title":"Add Agent management UI","description":"Frontend: Add ability to add/remove agents from squads. Show agent status, model, mentor relationships.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T19:42:11.481242+01:00","updated_at":"2025-12-31T20:03:11.230836+01:00","closed_at":"2025-12-31T20:03:11.230836+01:00","dependencies":[{"issue_id":"opencode-squads-52v.12","depends_on_id":"opencode-squads-52v","type":"parent-child","created_at":"2025-12-31T19:42:11.481704+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-52v.7","title":"Add project creation UI and mutations","description":"Frontend: Add useCreateProject mutation, project creation modal/form, project selector dropdown. Backend API already exists (POST /api/projects).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T19:42:03.182732+01:00","updated_at":"2025-12-31T20:02:34.664284+01:00","closed_at":"2025-12-31T20:02:34.664284+01:00","dependencies":[{"issue_id":"opencode-squads-52v.7","depends_on_id":"opencode-squads-52v","type":"parent-child","created_at":"2025-12-31T19:42:03.183754+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-52v.8","title":"Add Squad CRUD API endpoints","description":"Backend: Add SquadController with POST /api/projects/:id/squads (create), PATCH /api/squads/:id (update), DELETE /api/squads/:id (delete). Context functions already exist.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T19:42:05.151649+01:00","updated_at":"2025-12-31T20:21:10.208704+01:00","closed_at":"2025-12-31T20:21:10.208704+01:00","dependencies":[{"issue_id":"opencode-squads-52v.8","depends_on_id":"opencode-squads-52v","type":"parent-child","created_at":"2025-12-31T19:42:05.1521+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-52v.9","title":"Add Squad creation UI and mutations","description":"Frontend: Add useCreateSquad/useUpdateSquad/useDeleteSquad mutations, squad creation form. Depends on Squad CRUD API.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T19:42:06.808919+01:00","updated_at":"2025-12-31T20:02:37.87237+01:00","closed_at":"2025-12-31T20:02:37.87237+01:00","dependencies":[{"issue_id":"opencode-squads-52v.9","depends_on_id":"opencode-squads-52v","type":"parent-child","created_at":"2025-12-31T19:42:06.809434+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-54y","title":"Verify Agent Execution Loop and Ticket Context","description":"Verify how the Sessions context constructs the initial prompt for an agent. Ensure it includes ticket title and description when linked. Update Squads.Sessions if needed. Test by simulating a session start.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T10:28:44.058019+01:00","updated_at":"2026-01-01T10:52:18.53479+01:00","closed_at":"2026-01-01T10:52:18.53479+01:00"}
{"id":"opencode-squads-5b0","title":"Fleet view: connect squads across projects","description":"Problem\n- Squads are currently managed per-project with no global view. Collaboration between squads in different repos/projects is awkward.\n\nGoal\n- Add a \"Fleet\" (global) view where you can see all projects + squads and explicitly \"connect\" squads across projects to enable cross-team collaboration.\n\nKey use case\n- Example: a web app squad in repo A and an API squad in repo B. Connecting them enables coordination (via Agent Mail MCP) for feature requirements, contracts, and blockers.\n\nWork (high level)\n- Define a Fleet model and a SquadConnection model (global scope).\n- UI: Fleet dashboard showing projects, squads, and connections; search + filters.\n- Enable messaging workflows across connected squads (eg \"message API squad\" from web squad context).\n- Integrate with events to show cross-squad activity.\n\nNon-goals (initial)\n- Automatically merging repos or sharing code contexts.\n- Global authorization/SSO (unless needed by product).\n","design":"Design notes\n- Naming: Fleet/Network/Federation/Hub; pick one and keep it consistent.\n- Connection semantics: \"connected\" should be explicit and auditable (event logged).\n- Consider whether connections are symmetric or directed; default symmetric.\n","acceptance_criteria":"- There is a Fleet view that lists all projects and squads and their connection graph.\n- I can create/remove a connection between two squads in different projects.\n- Connected squads can communicate via agent mail workflows (at least a simple \"send message\" flow).\n","status":"in_progress","priority":2,"issue_type":"epic","created_at":"2026-01-02T10:11:51.305046+01:00","updated_at":"2026-01-05T10:06:58.860409+01:00","labels":["backend","collaboration","fleet","frontend","mail"]}
{"id":"opencode-squads-5bu","title":"Implement Docker MCP catalog ingestion","description":"Reference: docs/prd-mcp-agents.md (Integration: Docker MCP Catalog).\n\nImplement Squads.MCP.Catalog to ingest Docker MCP registry metadata. Fetch server list from docker/mcp-registry using the GitHub content API or a repo tarball. For each server, read server.yaml and tools.json, parse YAML and JSON into a normalized map (name, title, icon, category, tags, image, secrets, tools). Cache results with a TTL to avoid hitting GitHub for every request. Add basic filtering by search term, category, and tag.","acceptance_criteria":"- Catalog fetch returns list with normalized fields.\n- YAML parsing handled via a dependency or a safe parser.\n- Cache layer prevents frequent remote calls.\n- Errors return {:error, reason} without crashing.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T21:48:31.573965+01:00","updated_at":"2026-01-02T21:48:31.573965+01:00"}
{"id":"opencode-squads-5kx","title":"Terminate session from Agent UI returns 404","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T10:54:09.774403+01:00","updated_at":"2026-01-02T10:55:55.41183+01:00","closed_at":"2026-01-02T10:55:55.41183+01:00"}
{"id":"opencode-squads-5lo","title":"UX: declutter navigation and chrome","description":"Context\n- Ad-hoc UX review (Playwright) at http://localhost:4000.\n- UI feels cluttered due to many peer nav items + always-on telemetry + raw payloads.\n\nGoal\n- Reduce cognitive load without removing power features.\n- Make primary workflows obvious (Sessions, Squad, Board, Mail).\n","design":"Notes\n- Keep devtools visible in dev mode; hide in prod builds.\n- Maintain the terminal aesthetic but reduce ALL_CAPS noise for user-facing headers.\n","acceptance_criteria":"- Left nav grouped into Primary + Operations (collapsed by default).\n- Header shows minimal status; detailed telemetry lives behind an expandable drawer/tooltip.\n- Dashboard emphasizes 2-3 primary actions; secondary telemetry is de-emphasized.\n- Raw payloads (events/mail) are summarized by default with an explicit Details affordance.\n- Empty states include a clear next action (CTA).\n","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-02T17:50:46.490754+01:00","updated_at":"2026-01-05T09:55:39.827476+01:00","closed_at":"2026-01-05T09:55:39.827476+01:00","labels":["assets","frontend","ux"]}
{"id":"opencode-squads-5lo.2","title":"Sidebar IA: group navigation into Primary + Operations","description":"Problem\n- Left nav has many peer items (Overview/Squad/Sessions/Board/Agents/Review/Mail/Events/Nodes/Fleet), which increases scanning cost and makes the app feel busy.\n\nWork\n- Define primary workflows vs ops/admin tooling.\n- Implement grouped nav sections (e.g., Primary + Operations) with Operations collapsed by default.\n- Ensure command palette navigation stays in sync with new IA.\n","acceptance_criteria":"- Primary section contains only the most-used routes (â‰¤5).\n- Operations section contains admin/ops routes and is collapsed by default.\n- Active route highlighting works across sections.\n- No functionality is removed; routes remain reachable.\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T17:52:48.294003+01:00","updated_at":"2026-01-02T19:26:32.375169+01:00","closed_at":"2026-01-02T19:26:32.375169+01:00","labels":["assets","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-5lo.2","depends_on_id":"opencode-squads-5lo","type":"parent-child","created_at":"2026-01-02T17:52:48.295012+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5lo.3","title":"Header: move PATH/UPLINK/NODE into a status drawer","description":"Problem\n- The global header displays detailed telemetry (PATH, UPLINK state, NODE id) at all times, competing with primary page actions.\n\nWork\n- Replace always-on telemetry with a compact status pill (e.g., Connected/Offline) and move details into a drawer, tooltip, or popover.\n- Keep keyboard accessibility and quick glance status.\n","acceptance_criteria":"- Header shows only compact status + primary controls.\n- Detailed PATH/UPLINK/NODE info is available on-demand (drawer/tooltip).\n- No loss of debugging capability in dev mode.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T17:53:09.857285+01:00","updated_at":"2026-01-02T19:32:42.65501+01:00","closed_at":"2026-01-02T19:32:42.65501+01:00","labels":["assets","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-5lo.3","depends_on_id":"opencode-squads-5lo","type":"parent-child","created_at":"2026-01-02T17:53:09.858236+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5lo.4","title":"Dashboard: prioritize primary actions (Start Session / New Ticket / Compose)","description":"Problem\n- The dashboard reads as a status wall (sessions/projects/load + raw activity) but offers little immediate direction, especially when other pages are empty states.\n\nWork\n- Add 2-3 primary actions at the top (context-aware): Start/Resume Session, New Ticket, Compose Message.\n- De-emphasize secondary telemetry (move to smaller cards or status drawer).\n","acceptance_criteria":"- Dashboard surfaces clear primary CTAs within first viewport.\n- CTAs are context-aware (project selected).\n- Secondary telemetry remains accessible but no longer dominates layout.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T17:53:31.967041+01:00","updated_at":"2026-01-02T19:34:51.936206+01:00","closed_at":"2026-01-02T19:34:51.936206+01:00","labels":["assets","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-5lo.4","depends_on_id":"opencode-squads-5lo","type":"parent-child","created_at":"2026-01-02T17:53:31.967976+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5lo.5","title":"Progressive disclosure: summarize event/mail payloads by default","description":"Problem\n- Events and Recent Activity surfaces show truncated JSON payloads by default, which feels noisy and hard to scan.\n\nWork\n- Render human summaries as the primary row (kind + actor + target + timestamp).\n- Place raw payload behind a Details/Inspect affordance (modal/drawer) with copy button.\n- Reuse the same pattern across Dashboard, Events, and Mail where applicable.\n","acceptance_criteria":"- Lists are scannable: summary-first, payload on-demand.\n- Details view supports copy-to-clipboard and preserves formatting.\n- No loss of debugging detail in dev mode.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T17:53:57.541414+01:00","updated_at":"2026-01-02T19:36:29.735326+01:00","closed_at":"2026-01-02T19:36:29.735326+01:00","labels":["assets","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-5lo.5","depends_on_id":"opencode-squads-5lo","type":"parent-child","created_at":"2026-01-02T17:53:57.542534+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5lo.6","title":"Empty states: add action-oriented CTAs across pages","description":"Problem\n- Several routes land in empty states (Sessions, Board, Review, Nodes) that communicate status but not next steps, increasing the sense of emptiness/clutter.\n\nWork\n- For each empty state, add a clear next action button and short guidance:\n  - Sessions: Start a new session (choose agent)\n  - Board: Create first ticket\n  - Review: Link to how review items appear / what to do\n  - Nodes: Focus manual attach + discovery refresh\n","acceptance_criteria":"- Every empty state offers at least one primary CTA.\n- CTAs route to the correct creation flow (or open relevant modal).\n- Empty-state copy is concise and user-oriented.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T17:54:17.01901+01:00","updated_at":"2026-01-02T19:40:32.177506+01:00","closed_at":"2026-01-02T19:40:32.177506+01:00","labels":["assets","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-5lo.6","depends_on_id":"opencode-squads-5lo","type":"parent-child","created_at":"2026-01-02T17:54:17.020192+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5lo.7","title":"Consistency: standardize list page toolbars (search/filters/actions)","description":"Problem\n- List-like pages (Board, Agents, Events, Mail) have similar controls (search, filters, primary action) but vary in placement and visual hierarchy.\n\nWork\n- Define a shared toolbar layout pattern (left: search, middle: filters, right: primary action + view toggles).\n- Apply consistently across list pages.\n","acceptance_criteria":"- Board/Agents/Events/Mail use the same toolbar structure.\n- Primary action is consistently placed and styled.\n- Filters are discoverable and don't dominate content.\n","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-02T17:54:36.348204+01:00","updated_at":"2026-01-05T10:16:37.637631+01:00","closed_at":"2026-01-05T10:16:37.637631+01:00","labels":["assets","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-5lo.7","depends_on_id":"opencode-squads-5lo","type":"parent-child","created_at":"2026-01-02T17:54:36.349154+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5lo.8","title":"Utilities: consolidate floating terminal/devtools affordances","description":"Problem\n- Floating UI elements (e.g., system terminal button, devtools button) add persistent visual noise and compete with content.\n\nWork\n- Consolidate into a single Utilities menu (kebab/gear) with optional keyboard shortcuts.\n- Keep devtools visible in dev mode only.\n","acceptance_criteria":"- Only one persistent utilities entry is visible by default.\n- Terminal/devtools remain reachable via menu and shortcuts.\n- Utilities UI does not overlap core page actions.\n","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-02T17:54:53.495936+01:00","updated_at":"2026-01-02T17:54:53.495936+01:00","labels":["assets","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-5lo.8","depends_on_id":"opencode-squads-5lo","type":"parent-child","created_at":"2026-01-02T17:54:53.496947+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5mr","title":"Beads integration + ticket sync","description":"bd CLI adapter, ticket mirror, assignment endpoints, board API","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-31T11:16:32.793794+01:00","updated_at":"2025-12-31T14:35:56.064708+01:00","closed_at":"2025-12-31T14:35:56.064708+01:00","dependencies":[{"issue_id":"opencode-squads-5mr","depends_on_id":"opencode-squads-w37","type":"blocks","created_at":"2025-12-31T11:30:17.838006+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5mr.1","title":"CLI adapter for bd commands with --json parsing","description":"Wrapper to call bd ready/list/show/update/close/create and parse JSON","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:19:50.875742+01:00","updated_at":"2025-12-31T14:13:59.520486+01:00","closed_at":"2025-12-31T14:13:59.520486+01:00","dependencies":[{"issue_id":"opencode-squads-5mr.1","depends_on_id":"opencode-squads-5mr","type":"parent-child","created_at":"2025-12-31T11:19:50.876196+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-5mr.1","depends_on_id":"opencode-squads-w37.3","type":"blocks","created_at":"2025-12-31T11:32:06.399831+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5mr.2","title":"Ticket mirror schema + mapping","description":"Store Beads ID, status, assignee, deps mirror in Squads DB","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:19:56.057819+01:00","updated_at":"2025-12-31T14:21:50.907171+01:00","closed_at":"2025-12-31T14:21:50.907171+01:00","dependencies":[{"issue_id":"opencode-squads-5mr.2","depends_on_id":"opencode-squads-5mr","type":"parent-child","created_at":"2025-12-31T11:19:56.058796+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-5mr.2","depends_on_id":"opencode-squads-w37.4","type":"blocks","created_at":"2025-12-31T11:32:38.489544+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5mr.3","title":"Ticket list/ready/board API endpoints","description":"Expose ready/in-progress/blocked queries for UI","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:20:01.233165+01:00","updated_at":"2025-12-31T14:25:38.091896+01:00","closed_at":"2025-12-31T14:25:38.091896+01:00","dependencies":[{"issue_id":"opencode-squads-5mr.3","depends_on_id":"opencode-squads-5mr","type":"parent-child","created_at":"2025-12-31T11:20:01.23373+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-5mr.3","depends_on_id":"opencode-squads-5mr.1","type":"blocks","created_at":"2025-12-31T11:32:43.656581+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-5mr.3","depends_on_id":"opencode-squads-5mr.2","type":"blocks","created_at":"2025-12-31T11:32:48.840538+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5mr.4","title":"Assignment workflow: claim/unclaim/update status","description":"Map agent assignment to bd update --status/--assignee","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:20:06.417666+01:00","updated_at":"2025-12-31T14:28:35.740744+01:00","closed_at":"2025-12-31T14:28:35.740744+01:00","dependencies":[{"issue_id":"opencode-squads-5mr.4","depends_on_id":"opencode-squads-5mr","type":"parent-child","created_at":"2025-12-31T11:20:06.418174+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-5mr.4","depends_on_id":"opencode-squads-5mr.3","type":"blocks","created_at":"2025-12-31T11:32:54.014794+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5mr.5","title":"Ticket creation/close flow from UI","description":"Create and close tickets through backend API","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-31T11:20:11.608442+01:00","updated_at":"2025-12-31T14:30:18.559909+01:00","closed_at":"2025-12-31T14:30:18.559909+01:00","dependencies":[{"issue_id":"opencode-squads-5mr.5","depends_on_id":"opencode-squads-5mr","type":"parent-child","created_at":"2025-12-31T11:20:11.608993+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-5mr.5","depends_on_id":"opencode-squads-5mr.3","type":"blocks","created_at":"2025-12-31T11:32:59.175764+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5mr.6","title":"Link tickets to mail threads + sessions","description":"Use Beads ID as thread key and session context","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-31T11:20:16.793045+01:00","updated_at":"2025-12-31T14:35:45.941953+01:00","closed_at":"2025-12-31T14:35:45.941953+01:00","dependencies":[{"issue_id":"opencode-squads-5mr.6","depends_on_id":"opencode-squads-5mr","type":"parent-child","created_at":"2025-12-31T11:20:16.793502+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-5mr.6","depends_on_id":"opencode-squads-5mr.2","type":"blocks","created_at":"2025-12-31T11:33:04.344493+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-5mr.6","depends_on_id":"opencode-squads-7ug.2","type":"blocks","created_at":"2025-12-31T11:33:09.521897+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5qy","title":"Fix SSE ingester ref tracking","description":"In lib/squads/opencode/event_ingester.ex:60 Req.get returns a response ref, but start_sse_stream stores make_ref instead. handle_info only matches the stored ref, so incoming SSE chunks never get parsed. Use response.ref (or return it from Req.get) for tracking.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T17:55:43.146594+01:00","updated_at":"2025-12-31T18:01:45.651182+01:00","closed_at":"2025-12-31T18:01:45.651182+01:00"}
{"id":"opencode-squads-5y2","title":"OpenCode instance provisioning + squad status","description":"","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-03T08:19:25.517009+01:00","updated_at":"2026-01-03T08:19:25.517009+01:00"}
{"id":"opencode-squads-5y2.3","title":"Add OpenCode instance status registry keyed by project path","description":"Track provisioning/running/error for OpenCode instances keyed by project_path and share across squads.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T08:20:24.858644+01:00","updated_at":"2026-01-03T08:20:24.858644+01:00","dependencies":[{"issue_id":"opencode-squads-5y2.3","depends_on_id":"opencode-squads-5y2","type":"parent-child","created_at":"2026-01-03T08:20:24.859128+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5y2.4","title":"Expose squad opencode_status in API and UI","description":"Return computed opencode_status in squad responses and render Provisioning/Running/Error in the client.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T08:20:34.095706+01:00","updated_at":"2026-01-03T08:20:34.095706+01:00","dependencies":[{"issue_id":"opencode-squads-5y2.4","depends_on_id":"opencode-squads-5y2","type":"parent-child","created_at":"2026-01-03T08:20:34.096205+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-5y2.5","title":"Handle OpenCode process exit vs health transitions","description":"Avoid treating normal exit after health check as fatal; update status transitions for early exits.","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-03T08:20:39.280754+01:00","updated_at":"2026-01-03T08:20:39.280754+01:00","dependencies":[{"issue_id":"opencode-squads-5y2.5","depends_on_id":"opencode-squads-5y2","type":"parent-child","created_at":"2026-01-03T08:20:39.281294+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-64u","title":"Agent detail: session history list + switcher panel","description":"Problem\n- Once agent detail is reachable, we still only show the active session chat. There's no UX to select older sessions or understand session history.\n\nWork\n- Add a session list UI in the agent context, including historical statuses (completed/failed/cancelled).\n- Provide a \"selected session\" state and render its transcript via existing messages endpoint.\n- Make historical sessions read-only: disable composer and show status badge + timestamps.\n- Optional panels in the session view: Todos, Diff, Events (can be phased, but wireframe should allow).\n\nNotes\n- Prefer a mail-style split layout to avoid a separate \"details view\".\n","design":"UI suggestion\n- Left rail: tabs Active / History / All + search.\n- Session list item: status badge, session id short, ticket_key (if any), timestamps, termination provenance if available.\n- Main panel: SessionChat component in read-only mode for non-running sessions; add top-level tabs for Chat / Todos / Diff / Events.\n","acceptance_criteria":"- In the agent detail view, I can see a list of sessions for that agent (active + history) with status + created/started/finished timestamps.\n- Clicking a session switches the main panel to that session's transcript.\n- If the selected session is not active, the prompt composer is hidden/disabled and the UI clearly indicates read-only.\n- Switching sessions does not lose scroll position catastrophically (reasonable UX).\n","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-02T10:07:24.852855+01:00","updated_at":"2026-01-02T12:31:14.639725+01:00","closed_at":"2026-01-02T12:31:14.639725+01:00","labels":["frontend","sessions","ux"],"dependencies":[{"issue_id":"opencode-squads-64u","depends_on_id":"opencode-squads-v3q","type":"blocks","created_at":"2026-01-02T10:07:24.854591+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-65t","title":"Slash command /compact returns 502","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T17:05:18.394232+01:00","updated_at":"2026-01-05T09:27:43.96479+01:00","closed_at":"2026-01-05T09:27:43.96479+01:00"}
{"id":"opencode-squads-6gv","title":"Refactor Squad view to use Options menu instead of row click","description":"Disable row click navigation in Squad view. Move Details, Edit, and Delete actions to a 'More Options' dropdown menu to prevent accidental navigation on mobile.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T08:55:56.375869+01:00","updated_at":"2026-01-02T09:00:06.176681+01:00","closed_at":"2026-01-02T09:00:06.176681+01:00"}
{"id":"opencode-squads-6ip","title":"Implement Review Page Empty State","description":"Add a clear empty state for the /review page when there are no pending items, similar to the Squads page plan.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T20:54:57.331203+01:00","updated_at":"2026-01-01T21:42:50.724817+01:00","closed_at":"2026-01-01T21:42:50.724817+01:00"}
{"id":"opencode-squads-6is","title":"Agent session directory pollution (re-opened)","description":"Agents are being started in the wrong directory (on_boarding instead of project path) even when the project is correctly configured. This was previously addressed in opencode-squads-mdu but appears to still be failing in resolve_session_directory/2 fallback logic.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-01T15:56:29.533036+01:00","updated_at":"2026-01-01T17:47:14.412961+01:00","closed_at":"2026-01-01T17:47:14.412961+01:00"}
{"id":"opencode-squads-6m7","title":"Historical sessions should allow sending messages","description":"Historical sessions are currently marked as read-only. They should allow sending messages, which would reactivate the session if needed or continue the existing one.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T14:52:08.385998+01:00","updated_at":"2026-01-02T14:52:53.100102+01:00","closed_at":"2026-01-02T14:52:53.100102+01:00"}
{"id":"opencode-squads-6mi","title":"Add backpressure-safe SSE ingestion pipeline for EventIngester","description":"Problem:\n- EventIngester parses SSE chunks and writes to the DB inside handle_info.\n- Under bursty SSE or slow DB, the GenServer mailbox can back up and drop events.\n\nGoal:\n- Decouple ingestion from persistence and add backpressure or queueing.\n\nContext:\n- lib/squads/opencode/event_ingester.ex (handle_info for {:data, chunk} and persist_event).","design":"Approach options:\n- Keep SSE parsing in EventIngester, but hand off persistence to a supervised worker (Task.Supervisor) that batches or rate limits.\n- For stronger backpressure, use GenStage or Broadway with a bounded buffer.\n- Ensure failures in persistence do not crash the ingestion loop; log and decide retry or drop policy.","acceptance_criteria":"- EventIngester remains responsive under load (mailbox does not grow unbounded).\n- Persistence errors are handled without crashing the stream; behavior is documented.\n- Add tests or instrumentation to validate throughput and backpressure.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T20:56:51.78629+01:00","updated_at":"2026-01-02T08:40:28.245789+01:00","closed_at":"2026-01-02T08:40:28.245789+01:00"}
{"id":"opencode-squads-6zc","title":"(Optional) External node self-registration/heartbeat","description":"Idea\n- Provide an API for external OpenCode nodes (or a sidecar) to register themselves with Squads and periodically heartbeat. This avoids port scanning and works well in production/K8s.\n\nWork\n- POST /api/opencode/nodes/register { base_url, labels?, directory?, auth? }\n- POST /api/opencode/nodes/:id/heartbeat\n- Track last_seen and health status; surface in UI.\n\nNotes\n- This can be implemented by a lightweight cron/sidecar; does not require changes to opencode itself.\n","acceptance_criteria":"- An operator can deploy a small sidecar/cron that registers an external OpenCode server and keeps it visible in Squads.\n- Node disappears/stales cleanly if heartbeats stop.\n","status":"open","priority":3,"issue_type":"feature","created_at":"2026-01-02T10:11:21.765959+01:00","updated_at":"2026-01-02T10:11:21.765959+01:00","labels":["backend","discovery"],"dependencies":[{"issue_id":"opencode-squads-6zc","depends_on_id":"opencode-squads-oz5","type":"discovered-from","created_at":"2026-01-02T10:11:21.767344+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-72m","title":"Add Real-time System Event Stream","description":"A collapsible 'terminal' panel that streams live system events, agent logs, and status updates with typing effects.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-01T20:51:21.487316+01:00","updated_at":"2026-01-02T09:10:17.273627+01:00","closed_at":"2026-01-02T09:10:17.273627+01:00"}
{"id":"opencode-squads-72z","title":"Render OpenCode message parts in chat UI","description":"Parse /session/{sessionID}/message response (info + parts) and render text, tool, step, patch, file, retry, and meta parts cleanly.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T12:26:50.587843+01:00","updated_at":"2026-01-01T13:10:00.452838+01:00","closed_at":"2026-01-01T13:10:00.452839+01:00"}
{"id":"opencode-squads-779","title":"Implement /squads-status and /squads-tickets commands","description":"","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-31T21:18:30.176604+01:00","updated_at":"2025-12-31T22:56:11.895298+01:00","closed_at":"2025-12-31T22:56:11.895298+01:00","dependencies":[{"issue_id":"opencode-squads-779","depends_on_id":"opencode-squads-gwm","type":"blocks","created_at":"2025-12-31T21:18:30.177467+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7bt","title":"Chat UI: Command responses in toast instead of chat + crash on /sessions","description":"When sending commands in the chat UI, the response is returned in a toast and not in the chat window. Additionally, commands like /sessions trigger a 500 error with TypeError: undefined is not an object (evaluating 'command3.agent') at src/session/prompt.ts:1285:23 in the OpenCode server response.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T14:33:54.001044+01:00","updated_at":"2026-01-02T16:17:08.77851+01:00","closed_at":"2026-01-02T16:17:08.77851+01:00"}
{"id":"opencode-squads-7dp","title":"Ticket cache invalidation mismatch (['tickets'] vs project-scoped keys)","description":"Problem\n- useTickets caches tickets under a project-scoped key: [\"projects\", projectId, \"tickets\"] (assets/src/api/queries.ts:65).\n- SSE invalidation and some mutations invalidate [\"tickets\"] instead of the project-scoped key.\n\nWhere\n- assets/src/api/queries.ts:64-89 (useTickets queryKey)\n- assets/src/routes/__root.tsx:111-113 (SSE invalidates [\"tickets\"])\n- assets/src/api/queries.ts:676-679 (useUpdateTicket invalidates [\"tickets\"])\n\nImpact\n- Board can show stale data after ticket events/mutations until manual refresh.\n\nSuggested fix\n- Standardize ticket query keys and invalidation strategy:\n  - Either always use project-scoped keys and invalidate [\"projects\", projectId, \"tickets\"].\n  - Or introduce a canonical [\"tickets\"] key and make useTickets use it consistently.\n- Ensure SSE invalidation uses the active project ID if needed.\n","acceptance_criteria":"- Ticket events/mutations cause the visible board to refresh automatically.\n- React Query invalidation keys match the query keys used by useTickets.\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T17:40:15.305042+01:00","updated_at":"2026-01-02T19:24:21.311946+01:00","closed_at":"2026-01-02T19:24:21.311946+01:00","labels":["assets","board","frontend","react-query","tickets"],"dependencies":[{"issue_id":"opencode-squads-7dp","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T17:40:15.306837+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7dr","title":"Data model: squad connections across projects","description":"Work\n- Add persistent storage for cross-project squad connections.\n- Model should support:\n  - connecting squad A \u003c-\u003e squad B (likely symmetric)\n  - connection metadata (created_by, created_at, notes)\n  - status (active/disabled)\n- Emit events on connect/disconnect for audit + UI updates.\n\nNotes\n- Consider naming: fleet_connections / squad_links / federations.\n","acceptance_criteria":"- We can persist a connection between two squads (different projects supported).\n- Connections are queryable by squad and by project.\n- Connect/disconnect actions emit events for traceability.\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-02T10:12:08.872091+01:00","updated_at":"2026-01-02T17:25:28.584199+01:00","closed_at":"2026-01-02T17:25:28.584199+01:00","labels":["backend","db","fleet"],"dependencies":[{"issue_id":"opencode-squads-7dr","depends_on_id":"opencode-squads-5b0","type":"blocks","created_at":"2026-01-02T10:12:08.874072+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7r5","title":"Devtools overlay blocks plan/build toggle in dev","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T17:05:08.01596+01:00","updated_at":"2026-01-05T09:05:16.879051+01:00","closed_at":"2026-01-05T09:05:16.879051+01:00"}
{"id":"opencode-squads-7ug","title":"Mail MCP (DB-only) + reservations","description":"In-house mail tools, inbox/thread/search/ack, file reservations, event hooks","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-31T11:16:41.250523+01:00","updated_at":"2025-12-31T15:17:37.077608+01:00","closed_at":"2025-12-31T15:17:37.077608+01:00","dependencies":[{"issue_id":"opencode-squads-7ug","depends_on_id":"opencode-squads-w37","type":"blocks","created_at":"2025-12-31T11:30:22.999847+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7ug.1","title":"Mail DB schema (message, recipient, thread, ack/read)","description":"Ecto schemas/migrations for mail messages, recipients, threads","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:20:32.228113+01:00","updated_at":"2025-12-31T15:08:34.034898+01:00","closed_at":"2025-12-31T15:08:34.034898+01:00","dependencies":[{"issue_id":"opencode-squads-7ug.1","depends_on_id":"opencode-squads-7ug","type":"parent-child","created_at":"2025-12-31T11:20:32.228565+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-7ug.1","depends_on_id":"opencode-squads-w37.4","type":"blocks","created_at":"2025-12-31T11:33:14.677905+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7ug.2","title":"Mail API: send/inbox/thread/search/ack","description":"REST/MCP endpoints for mailbox operations","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:20:37.415341+01:00","updated_at":"2025-12-31T15:16:22.20875+01:00","closed_at":"2025-12-31T15:16:22.20875+01:00","dependencies":[{"issue_id":"opencode-squads-7ug.2","depends_on_id":"opencode-squads-7ug","type":"parent-child","created_at":"2025-12-31T11:20:37.415809+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-7ug.2","depends_on_id":"opencode-squads-7ug.1","type":"blocks","created_at":"2025-12-31T11:33:19.857447+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7ug.3","title":"File reservations: schema + reserve/release/list","description":"Advisory reservations with TTL and conflict detection","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:20:42.607245+01:00","updated_at":"2025-12-31T15:17:30.108388+01:00","closed_at":"2025-12-31T15:17:30.108388+01:00","dependencies":[{"issue_id":"opencode-squads-7ug.3","depends_on_id":"opencode-squads-7ug","type":"parent-child","created_at":"2025-12-31T11:20:42.607705+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-7ug.3","depends_on_id":"opencode-squads-7ug.1","type":"blocks","created_at":"2025-12-31T11:33:25.025171+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7ug.4","title":"Mentor routing + escalation handling","description":"Route junior questions to mentor, support escalation","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-31T11:20:47.797269+01:00","updated_at":"2025-12-31T22:58:03.381314+01:00","closed_at":"2025-12-31T22:58:03.381314+01:00","dependencies":[{"issue_id":"opencode-squads-7ug.4","depends_on_id":"opencode-squads-7ug","type":"parent-child","created_at":"2025-12-31T11:20:47.797777+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-7ug.4","depends_on_id":"opencode-squads-7ug.2","type":"blocks","created_at":"2025-12-31T11:33:30.214231+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-7ug.4","depends_on_id":"opencode-squads-w37.5","type":"blocks","created_at":"2025-12-31T11:33:35.399688+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7ug.5","title":"Mail events into unified SSE stream","description":"Emit mail/reservation events for UI updates","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:20:52.982748+01:00","updated_at":"2025-12-31T17:09:02.821694+01:00","closed_at":"2025-12-31T17:09:02.821694+01:00","dependencies":[{"issue_id":"opencode-squads-7ug.5","depends_on_id":"opencode-squads-7ug","type":"parent-child","created_at":"2025-12-31T11:20:52.983259+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-7ug.5","depends_on_id":"opencode-squads-7ug.2","type":"blocks","created_at":"2025-12-31T11:33:40.575436+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7ug.6","title":"Add OpenCode /check-mail command definition","description":"Custom command to check inbox manually in OpenCode","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-31T11:20:58.170771+01:00","updated_at":"2025-12-31T22:58:33.207004+01:00","closed_at":"2025-12-31T22:58:33.207004+01:00","dependencies":[{"issue_id":"opencode-squads-7ug.6","depends_on_id":"opencode-squads-7ug","type":"parent-child","created_at":"2025-12-31T11:20:58.171265+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-7ug.6","depends_on_id":"opencode-squads-7ug.2","type":"blocks","created_at":"2025-12-31T11:33:45.738481+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7wz","title":"Optimize mobile font sizes and UI scaling","description":"The font size and UI elements are too large on mobile devices, making navigation difficult (e.g., chat button in Squads view is inaccessible). Adjust Tailwind classes for responsive sizing.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-02T08:45:09.131874+01:00","updated_at":"2026-01-02T08:49:42.817259+01:00","closed_at":"2026-01-02T08:49:42.817259+01:00"}
{"id":"opencode-squads-7zw","title":"Backend audit: OTP + abstractions to 10/10","description":"Context\\n- Performed a review of the Elixir/Phoenix backend under lib/.\\n- Current rating: ~6/10 due to OTP/process structure, crashy boundary code, and large modules with mixed responsibilities.\\n\\nProblems observed (examples)\\n- One GenServer manages all per-project OpenCode OS processes (lib/squads/opencode/server.ex).\\n- Large mixed-responsibility module: Sessions context (lib/squads/sessions.ex).\\n- Controllers contain domain/test-shaping logic and deep nested case/cond (lib/squads_web/controllers/api/session_controller.ex).\\n- Crashy patterns reachable from API: Repo.get!/insert!/update!, Jason.decode!, String.to_existing_atom on params, etc.\\n- Duplicated OpenCode node discovery logic (lib/squads/opencode/discovery.ex vs lib/squads/sessions.ex).\\n\\nGoal\\n- Improve correctness, maintainability, and OTP alignment so future work is safer and easier.\\n\\nOut of scope\\n- Frontend/assets work (tracked elsewhere).\\n\\nDeliverable\\n- Close all child issues under this epic; keep changes incremental and well-tested.","acceptance_criteria":"- All child issues under this epic are closed.\\n- mix test passes.\\n- No API endpoints can raise due to Repo.*!, Jason.decode!, String.to_existing_atom, or similar crashy patterns.\\n- OpenCode process management uses supervision and per-project workers (no single god-process).","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-02T18:55:02.08746+01:00","updated_at":"2026-01-02T18:55:02.08746+01:00","labels":["audit","backend","elixir","otp","refactor"]}
{"id":"opencode-squads-7zw.10","title":"Sessions: refactor OpenCode integration (fix inconsistent returns + reduce nested flow)","description":"Problem\\n- lib/squads/sessions.ex is a large mixed-responsibility module (DB lifecycle + OpenCode orchestration + command routing + node discovery).\\n- There are deep nested cond/case blocks and at least one inconsistent return type that can break callers.\\n\\nConcrete issues to address in this task\\n1) ensure_session_running/2 can return a bare boolean in the test-env branch (lib/squads/sessions.ex:843+).\\n   - This breaks the contract used by callers expecting {:ok, session} | {:error, reason}.\\n2) Duplicate logic exists between create_and_start_session/2 and start_session/2 for:\\n   - ensuring the OpenCode server\\n   - creating the OpenCode session\\n   - updating the local session and metadata\\n\\nSuggested approach (incremental)\\n- Step 1: Write down the return contracts for the key helpers and make them consistent:\\n  - ensure_session_running(session, opts) returns {:ok, session} | {:error, reason}\\n  - with_base_url(session, opts) returns keyword list opts\\n- Step 2: Fix the test_env? branch so it returns {:ok, session} or {:error, :session_not_active}; it must never return a bare boolean like true/false.\\n- Step 3: Extract the common OpenCode session startup into one helper (private function or new module), so both create_and_start_session/2 and start_session/2 call the same code path.\\n- Step 4: Reduce nesting using with-expressions and function heads/guards.\\n\\nHow to test\\n- Add unit tests for ensure_session_running/2 covering:\\n  - session.status == \"running\"\\n  - session.opencode_session_id missing/invalid\\n  - test env behavior (with and without bypass flag)\\n- Run: mix test","acceptance_criteria":"- ensure_session_running/2 always returns {:ok, session} | {:error, reason} (no bare booleans).\\n- create_and_start_session/2 and start_session/2 share a single implementation for OpenCode session startup.\\n- Code readability improves (reduced nesting / smaller helpers).\\n- mix test passes.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-02T18:59:15.522383+01:00","updated_at":"2026-01-02T19:00:13.168769+01:00","labels":["backend","elixir","refactor","sessions"],"dependencies":[{"issue_id":"opencode-squads-7zw.10","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T18:59:15.522921+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7zw.11","title":"SessionController: simplify nested case/cond and remove test-shaping logic","description":"Problem\\n- SessionController contains deep nested cond/case blocks and controller-level logic that exists mainly to satisfy tests (commented as such).\\n- This makes behavior hard to reason about and increases the chance of inconsistent HTTP statuses between endpoints.\\n\\nWhere\\n- lib/squads_web/controllers/api/session_controller.ex\\n  - index/2 uses cond for filtering (lines ~23-40)\\n  - prompt/prompt_async/command/shell have nested case/cond trees (lines ~221+)\\n  - several branches explicitly mention test expectations (lines ~241, ~384)\\n\\nSuggested refactor\\n1) Move business rules into Squads.Sessions (or a small wrapper module) so the controller mostly does:\\n   - parse/validate params\\n   - call context functions\\n   - render results\\n2) Standardize error tuples coming from the context:\\n   - {:error, :not_found} -\u003e 404\\n   - {:error, :session_not_active} -\u003e 409\\n   - {:error, :no_opencode_session} -\u003e 409\\n   - {:error, {:opencode_error, reason}} -\u003e 502\\n3) Remove duplicated logic between prompt and prompt_async by extracting shared path (build opts, resolve session vs external, dispatch).\\n4) If tests force odd behavior, update tests to match the new documented behavior, or encode the behavior in the context (not the controller).\\n\\nHow to test\\n- Run: mix test (SessionController tests should cover these endpoints).\\n- Manual smoke test the API endpoints:\\n  - /api/sessions/:id/prompt\\n  - /api/sessions/:id/command\\n  - /api/sessions/:id/shell","acceptance_criteria":"- SessionController functions are shorter and have minimal nesting.\\n- No controller code path exists purely as an ad-hoc test workaround; behavior is documented in context functions.\\n- Error-to-HTTP mapping is consistent across prompt/command/shell endpoints.\\n- mix test passes.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T19:00:33.547065+01:00","updated_at":"2026-01-02T19:00:33.547065+01:00","labels":["backend","controllers","elixir","phoenix","refactor"],"dependencies":[{"issue_id":"opencode-squads-7zw.11","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T19:00:33.547614+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7zw.12","title":"Testing: add behaviours/mocks for external integrations (OpenCode HTTP, System.cmd, exec)","description":"Problem\\n- Several parts of the backend call external systems directly:\\n  - OpenCode over HTTP (Squads.OpenCode.Client)\\n  - OS commands via System.cmd (git, lsof, bd)\\n  - OS process execution via :exec.run_link\\n- This makes unit tests brittle or forces test-only branches in production code.\\n\\nGoal\\n- Make it easy to test logic without hitting real OpenCode servers or running real git/bd commands.\\n\\nSuggested approach\\n1) Introduce small behaviours for each external boundary:\\n   - OpenCodeClient behaviour (list_sessions, create_session, abort_session, etc)\\n   - CommandRunner behaviour (cmd/3 wrapper around System.cmd)\\n   - ExecRunner behaviour for :exec.run_link\\n2) Configure the implementation via Application env (default to real modules).\\n3) In tests, use Mox (or simple test stubs) to assert calls and return controlled results.\\n4) Remove/avoid test_env? conditionals in production code once behaviours exist.\\n\\nHow to test\\n- Add a unit test that simulates OpenCode returning not_found and verifies Sessions returns {:error, :session_not_active} (or correct mapping) without any HTTP calls.\\n- Run: mix test","acceptance_criteria":"- Core modules can be unit tested without calling external processes.\\n- At least one integration (OpenCode client) is mocked in tests to cover error branches.\\n- Reduced need for test-specific branches in production code.\\n- mix test passes.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-02T19:00:55.36081+01:00","updated_at":"2026-01-02T19:00:55.36081+01:00","labels":["backend","elixir","refactor","testing"],"dependencies":[{"issue_id":"opencode-squads-7zw.12","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T19:00:55.361367+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7zw.13","title":"Agents.get_squad/1 references non-existent schema module","description":"Problem\\n- Squads.Agents.get_squad/1 calls Repo.get(Squads.Agents.Squad, id).\\n- There is no Squads.Agents.Squad schema module in the codebase, so if this function is called it will crash at runtime.\\n\\nWhere\\n- lib/squads/agents.ex:178-185\\n\\nSuggested fix\\n- Decide the intended behavior:\\n  - Either delegate to Squads.Squads.get_squad/1, OR\\n  - Use Repo.get(Squads.Squads.Squad, id) (and alias it).\\n- Add/adjust a unit test that calls Agents.get_squad/1 with an existing squad and verifies it returns {:ok, squad}.\\n\\nHow to test\\n- Run: mix test","acceptance_criteria":"- Agents.get_squad/1 no longer references a non-existent module.\\n- Function works for valid squad ids and returns {:error, :not_found} when missing.\\n- mix test passes.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-02T19:01:47.385637+01:00","updated_at":"2026-01-02T19:27:13.66724+01:00","closed_at":"2026-01-02T19:27:13.66724+01:00","labels":["agents","backend","bug","elixir"],"dependencies":[{"issue_id":"opencode-squads-7zw.13","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T19:01:47.386156+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7zw.3","title":"MCP: fix Agents.get_agent/1 contract mismatch (crash in escalate)","description":"Problem\\n- Squads.MCP expects Squads.Agents.get_agent/1 to return {:ok, agent} | {:error, :not_found}.\\n- Actual implementation returns Agent.t() | nil (lib/squads/agents.ex:38).\\n- In the \"escalate\" MCP tool, this causes a with-clause mismatch and can raise WithClauseError or return the wrong error.\\n\\nWhere\\n- lib/squads/mcp.ex:73 (with {:ok, agent} \u003c- Squads.Agents.get_agent(agent_id))\\n- lib/squads/agents.ex:38 (get_agent/1 returns Repo.get/2)\\n\\nSuggested fix\\n- Option A (preferred):\\n  - Add a new function like Squads.Agents.fetch_agent/1 that returns {:ok, agent} | {:error, :not_found}.\\n  - Update lib/squads/mcp.ex to use fetch_agent/1 and adjust error messages: \\n    - unknown agent -\u003e \"Agent not found\"\\n    - no mentor -\u003e \"No mentor assigned\"\\n- Option B: Change get_agent/1 to return tuples, but this is riskier because other callers expect nil.\\n\\nHow to test\\n- Call POST /api/mcp/agent_mail/connect with method=call_tool name=escalate (or hit MCP directly)\\n  - valid agent_id with mentor_id -\u003e should send mail and return ok\\n  - valid agent_id with no mentor_id -\u003e should return code -32001\\n  - invalid/nonexistent agent_id -\u003e should return code -32002\\n- Run: mix test","acceptance_criteria":"- MCP escalate no longer raises WithClauseError.\\n- Nonexistent agent returns \"Agent not found\" (code -32002).\\n- Agent without mentor returns \"No mentor assigned\" (code -32001).\\n- mix test passes.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T18:56:32.752784+01:00","updated_at":"2026-01-02T19:27:08.49171+01:00","closed_at":"2026-01-02T19:27:08.49171+01:00","labels":["backend","bug","elixir","mcp"],"dependencies":[{"issue_id":"opencode-squads-7zw.3","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T18:56:32.753422+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7zw.4","title":"Mail: make send_message non-crashy (remove Repo.*! + to_existing_atom on params)","description":"Problem\\n- Squads.Mail.send_message/1 is reachable from API/controller/MCP paths and can raise on malformed input.\\n- It uses Repo.insert!/Repo.update!/Repo.get! inside a transaction and String.to_existing_atom/1 on user-provided keys.\\n- Result: bad params can crash the request process (500) instead of returning a clean {:error, ...}.\\n\\nWhere\\n- lib/squads/mail.ex:80 (send_message/1)\\n  - Repo.insert!/Repo.update!/Repo.get! in multiple places\\n  - Converts attrs keys with String.to_existing_atom/1 (will raise for unknown keys)\\n- lib/squads_web/controllers/api/mail_controller.ex:97 (passes raw params to Mail.send_message/1)\\n- lib/squads/mcp.ex:15-22 (MCP send_message tool uses Mail.send_message/1)\\n\\nSuggested fix (safe incremental)\\n1) Remove String.to_existing_atom conversion.\\n   - Ecto changeset cast supports string keys; pass through only whitelisted fields.\\n   - Example approach: build message_attrs from Map.take(attrs, [\"subject\",\"body_md\",...]) and let changeset handle it.\\n2) Replace Repo.insert!/update!/get! with non-bang versions.\\n   - Use Ecto.Multi (preferred) or manual transaction + Repo.rollback with reason/changeset.\\n   - Ensure thread lookup by thread_id returns {:error, :not_found} instead of raising.\\n3) Keep return contract consistent: {:ok, message} | {:error, reason_or_changeset}.\\n4) Update MailController + MCPController/Fallback mapping if needed (prefer using action_fallback for errors).\\n\\nHow to test\\n- Add/extend tests for Mail.send_message/1 (and controller if tests exist):\\n  - Unknown extra params do not crash\\n  - Invalid thread_id returns {:error, :not_found}\\n  - Missing subject/project_id returns {:error, ...} (not rollback crash)\\n- Run: mix test","acceptance_criteria":"- Mail.send_message/1 never raises for bad user input; it returns {:error, ...}.\\n- Unknown keys in params do not crash (no to_existing_atom).\\n- Controllers return proper 4xx/422 responses instead of 500.\\n- mix test passes.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T18:57:00.202422+01:00","updated_at":"2026-01-02T19:27:18.830209+01:00","closed_at":"2026-01-02T19:27:18.830209+01:00","labels":["backend","bug","elixir","hardening","mail"],"dependencies":[{"issue_id":"opencode-squads-7zw.4","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T18:57:00.202954+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7zw.5","title":"Reservations: make reserve_paths non-crashy (remove Repo.insert! in transaction)","description":"Problem\\n- Squads.Reservations.reserve_paths/4 inserts reservations using Repo.insert! inside Repo.transaction.\\n- If the changeset is invalid (bad UUIDs, missing fields, etc), insert! will raise and crash the calling process instead of returning {:error, changeset}.\\n\\nWhere\\n- lib/squads/reservations.ex:25-78 (reserve_paths/4)\\n\\nSuggested fix\\n- Replace Repo.insert! with Repo.insert and handle {:error, changeset}:\\n  - Either build an Ecto.Multi that inserts each FileReservation and returns a combined result, or\\n  - Keep the manual transaction and call Repo.rollback({:validation_error, changeset}) on first failure.\\n- Ensure the function returns {:ok, reservations} | {:error, reason} consistently.\\n- Make sure events are only created when the transaction succeeds.\\n\\nHow to test\\n- Add a unit test that passes an invalid agent_id/project_id and asserts reserve_paths returns {:error, ...} (no exception).\\n- Run: mix test","acceptance_criteria":"- reserve_paths/4 never raises on invalid input; returns {:error, ...}.\\n- Successful reservation still creates the event and returns inserted rows.\\n- mix test passes.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T18:57:17.507697+01:00","updated_at":"2026-01-02T18:57:17.507697+01:00","labels":["backend","elixir","hardening","reservations"],"dependencies":[{"issue_id":"opencode-squads-7zw.5","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T18:57:17.50826+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7zw.6","title":"Beads adapter: avoid Jason.decode! on CLI output; return structured errors","description":"Problem\\n- Squads.Beads.Adapter uses System.cmd(..., stderr_to_stdout: true) and then Jason.decode!/1 on the output.\\n- If bd prints any non-JSON text (warnings, progress, errors that still exit 0, etc) Jason.decode! will raise and crash callers.\\n\\nWhere\\n- lib/squads/beads/adapter.ex:11-16 (list_issues/1)\\n- lib/squads/beads/adapter.ex:21-25 (ready_issues/1)\\n- lib/squads/beads/adapter.ex:31-35 (show_issue/2)\\n- lib/squads/beads/adapter.ex:41-74 (update_* / create_issue)\\n\\nSuggested fix\\n- Replace Jason.decode!/1 with Jason.decode/1 across the adapter.\\n- When JSON decode fails, return {:error, {:invalid_json, output}} (include raw output for debugging) instead of raising.\\n- Keep the existing {:error, :no_beads_db} special-case.\\n- Update Squads.Tickets callers to handle {:error, {:invalid_json, _}} and surface a clear error (likely 502 from controllers).\\n\\nHow to test\\n- Add unit tests for adapter parsing by stubbing System.cmd (preferred via a small behaviour like Squads.SystemCmd) OR write tests that call a fake script that outputs invalid JSON.\\n- Ensure callers (Tickets.sync_* / create_via_beads) return {:error, {:beads_error, ...}} and do not raise.\\n- Run: mix test","acceptance_criteria":"- Adapter never raises due to JSON parsing; returns {:error, {:invalid_json, output}}.\\n- Ticket sync/create endpoints return stable error tuples and do not crash.\\n- mix test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T18:57:36.745033+01:00","updated_at":"2026-01-02T19:27:23.99755+01:00","closed_at":"2026-01-02T19:27:23.99755+01:00","labels":["backend","beads","elixir","hardening"],"dependencies":[{"issue_id":"opencode-squads-7zw.6","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T18:57:36.745553+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7zw.7","title":"Worktrees: harden API paths (avoid Repo.get! and long System.cmd in request)","description":"Problem\\n- Squads.Worktrees functions are called from API controllers and can raise (Repo.get! and File/OS calls).\\n- Creating/removing worktrees also runs git commands (System.cmd) synchronously in the request path, which can hang or be slow.\\n\\nWhere\\n- lib/squads/worktrees.ex:14 (ensure_worktree/3 uses Repo.get!)\\n- lib/squads_web/controllers/api/worktree_controller.ex:23 (create endpoint calls ensure_worktree)\\n- lib/squads/worktrees.ex:40+ (System.cmd git worktree/merge/remove)\\n\\nSuggested fix\\n1) Replace Repo.get! calls with Repo.get and return {:error, :not_found} when IDs are invalid/missing.\\n2) Validate UUIDs at the controller boundary (or inside context) so invalid IDs return 404/400 cleanly.\\n3) Consider moving git operations to Task.Supervisor (Squads.OpenCode.TaskSupervisor) so API remains responsive:\\n   - Controller triggers work, returns 202 + operation id, OR\\n   - Keep synchronous for now but add a timeout and better error formatting.\\n\\nHow to test\\n- Unit test Worktrees.ensure_worktree with nonexistent project/agent/ticket returns {:error, :not_found}.\\n- Manual: call POST /api/projects/:id/worktrees with invalid ids; ensure no 500s.\\n- Run: mix test","acceptance_criteria":"- Worktree endpoints never raise for invalid IDs; return 4xx with clear error.\\n- Git command failures are returned as {:error, reason} and surfaced as 502/422 (not 500).\\n- mix test passes.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T18:57:55.902618+01:00","updated_at":"2026-01-02T18:57:55.902618+01:00","labels":["backend","elixir","hardening","worktrees"],"dependencies":[{"issue_id":"opencode-squads-7zw.7","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T18:57:55.903119+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7zw.8","title":"OpenCode OTP: supervise per-project servers (DynamicSupervisor + ProjectServer worker)","description":"Problem\\n- Squads.OpenCode.Server is a single GenServer that manages *all* project OpenCode OS processes in one internal map (state.servers).\\n- This concentrates failure/restart logic, makes concurrency harder, and forces custom bookkeeping (waiters list, task refs, manual cleanup).\\n\\nWhere\\n- lib/squads/opencode/server.ex (central manager)\\n- lib/squads/application.ex:17-20 (Registry + TaskSupervisor + Server startup)\\n\\nGoal\\n- Align with OTP: one process per resource (one OpenCode server per project) supervised under a DynamicSupervisor.\\n- Keep the public API roughly the same (ensure_running/2, get_url/1) so callers donâ€™t change much.\\n\\nSuggested implementation\\n1) Add a DynamicSupervisor (e.g., Squads.OpenCode.ProjectSupervisor) started from Squads.Application.\\n2) Add a per-project worker (e.g., Squads.OpenCode.ProjectServer) as a GenServer:\\n   - Named via Registry (e.g., {:via, Registry, {Squads.OpenCode.ServerRegistry, project_id}}).\\n   - Starts the OS process (opencode serve ...) and stores url/port in state.\\n   - Handles health check \u0026 transitions to running.\\n   - Handles process exit cleanup.\\n3) Change Squads.OpenCode.Server to be a thin facade:\\n   - ensure_running(project_id, path) -\u003e start child under DynamicSupervisor if needed, then call the per-project server to ensure itâ€™s running and return url.\\n   - list_running_servers -\u003e query Registry / DynamicSupervisor children (no custom global state).\\n\\nHow to test\\n- Unit test: calling ensure_running twice concurrently returns same url and does not start two OS processes (can be simulated by mocking exec runner).\\n- Manual: start two projects and verify both URLs are reachable and independent.\\n- Run: mix test","design":"Design notes\\n- Prefer DynamicSupervisor + Registry naming to avoid global maps.\\n- Decide how to manage ports (still ok to pick an ephemeral port; consider reserving in the worker).\\n- Consider isolating OS exec into a behaviour for testability (see separate issue about external integration behaviours).","acceptance_criteria":"- Per-project OpenCode servers are supervised as separate processes.\\n- A crash/restart of one project server does not affect others.\\n- ensure_running/2 returns {:ok, url} reliably under concurrent calls.\\n- mix test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T18:58:30.085489+01:00","updated_at":"2026-01-02T21:54:46.721225+01:00","closed_at":"2026-01-02T21:54:46.721225+01:00","labels":["backend","elixir","opencode","otp","refactor"],"dependencies":[{"issue_id":"opencode-squads-7zw.8","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T18:58:30.086028+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-7zw.9","title":"OpenCode: centralize base_url resolution and remove duplicated lsof discovery","description":"Problem\\n- OpenCode node discovery / base_url resolution is duplicated in multiple places.\\n- Squads.OpenCode.Discovery probes config + local ports (lsof).\\n- Squads.Sessions also implements its own lsof scanning and project matching logic.\\n- This duplication makes behavior inconsistent and harder to maintain.\\n\\nWhere\\n- lib/squads/opencode/discovery.ex (discover_nodes/0, probe_node/1, lsof scan)\\n- lib/squads/sessions.ex:1025+ (local_opencode_candidates/0 + extract_port/1)\\n- lib/squads/sessions.ex:956+ (get_base_url_for_session/1 + discover_base_url/2)\\n\\nSuggested fix\\n- Introduce a single module responsible for resolving base_url, e.g. Squads.OpenCode.Resolver with a function like:\\n  resolve_base_url(project_id, project_path, opts \\ []) -\u003e {:ok, url} | {:error, reason}\\n- Make Sessions and any other callers use this module instead of duplicating lsof parsing.\\n- Ensure the resolver's priority order is documented and consistent (example):\\n  1) explicit opts[:base_url] (if passed)\\n  2) session.metadata[\"opencode_base_url\"] (if present and matches project)\\n  3) Registry (Server.get_url/1)\\n  4) Discovery.discover_nodes() + probe project match\\n  5) Start a server via Server.ensure_running/2\\n\\nHow to test\\n- Unit tests for resolver ordering (can stub OpenCode.Client.get_current_project/1 and Discovery outputs).\\n- Verify Sessions.send_prompt/3 works when the server is:\\n  - already registered\\n  - discoverable via lsof\\n  - not running (requires starting)\\n- Run: mix test","acceptance_criteria":"- Only one place implements lsof/config discovery for OpenCode nodes.\\n- Sessions no longer contains duplicated lsof scanning code.\\n- Base URL resolution behavior is consistent across features.\\n- mix test passes.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T18:58:51.782641+01:00","updated_at":"2026-01-02T18:58:51.782641+01:00","labels":["backend","elixir","opencode","refactor"],"dependencies":[{"issue_id":"opencode-squads-7zw.9","depends_on_id":"opencode-squads-7zw","type":"parent-child","created_at":"2026-01-02T18:58:51.783223+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803","title":"Frontend UI (Vite + React + TUI theme)","description":"Vite+React in Phoenix assets, TanStack stack, TUI styling, live SSE dashboards","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-31T11:16:58.127346+01:00","updated_at":"2026-01-01T08:43:32.416426+01:00","closed_at":"2026-01-01T08:43:32.416426+01:00","dependencies":[{"issue_id":"opencode-squads-803","depends_on_id":"opencode-squads-w37","type":"blocks","created_at":"2025-12-31T11:30:33.331874+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.1","title":"Vite + React + Tailwind setup + TUI theme tokens","description":"Bootstrap Vite+React in Phoenix assets, Tailwind config, TUI palette/typography (no esbuild)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:21:56.079715+01:00","updated_at":"2025-12-31T12:02:05.564709+01:00","closed_at":"2025-12-31T12:02:05.564709+01:00","dependencies":[{"issue_id":"opencode-squads-803.1","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T11:21:56.080186+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.1","depends_on_id":"opencode-squads-w37.3","type":"blocks","created_at":"2025-12-31T11:34:42.603102+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.12","title":"Fix Vite helper function signature in root layout","description":"root.html.heex calls SquadsWeb.Vite.vite_assets(%{}) but the function is defined as vite_assets/0. Either update the layout to call vite_assets() or update the Vite module to accept a map argument.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-31T12:10:22.166142+01:00","updated_at":"2025-12-31T13:33:55.000986+01:00","closed_at":"2025-12-31T13:33:55.000986+01:00","dependencies":[{"issue_id":"opencode-squads-803.12","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T12:10:22.167273+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.2","title":"App shell + navigation (TanStack Router)","description":"Layout, navigation, and route structure","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:22:01.2621+01:00","updated_at":"2025-12-31T12:05:51.943983+01:00","closed_at":"2025-12-31T12:05:51.943983+01:00","dependencies":[{"issue_id":"opencode-squads-803.2","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T11:22:01.262644+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.2","depends_on_id":"opencode-squads-803.1","type":"blocks","created_at":"2025-12-31T11:34:47.761783+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.21","title":"Implement unified notification/toast system (TUI style)","description":"A system-wide toast notification system using the terminal aesthetic for SSE event alerts","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-31T14:18:59.152948+01:00","updated_at":"2025-12-31T14:20:40.388593+01:00","closed_at":"2025-12-31T14:20:40.388593+01:00","dependencies":[{"issue_id":"opencode-squads-803.21","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T14:18:59.153876+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.22","title":"Mail UI: Integrated mailbox and thread view","description":"Complete the mail route with a functional inbox, thread list, and message reading interface using real API hooks","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-31T14:19:04.296268+01:00","updated_at":"2025-12-31T14:27:33.084504+01:00","closed_at":"2025-12-31T14:27:33.084504+01:00","dependencies":[{"issue_id":"opencode-squads-803.22","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T14:19:04.29693+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.23","title":"Review Queue: Master-detail implementation","description":"Implement the review queue UI with side-by-side diff viewing and approval actions","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-31T14:19:09.442326+01:00","updated_at":"2025-12-31T17:59:30.206427+01:00","closed_at":"2025-12-31T17:59:30.206427+01:00","dependencies":[{"issue_id":"opencode-squads-803.23","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T14:19:09.443381+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.24","title":"Ticket Board: Interactive status updates","description":"Add ability to update ticket status via the UI using the useUpdateTicket mutation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-31T14:19:14.601978+01:00","updated_at":"2025-12-31T17:52:19.134596+01:00","closed_at":"2025-12-31T17:52:19.134596+01:00","dependencies":[{"issue_id":"opencode-squads-803.24","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T14:19:14.603029+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.27","title":"Implement Graphical Dependency Map (React Flow)","description":"Add a visual dependency map of tickets using React Flow to visualize relationships and blockers","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-31T17:45:27.942225+01:00","updated_at":"2025-12-31T17:52:24.273524+01:00","closed_at":"2025-12-31T17:52:24.273524+01:00","dependencies":[{"issue_id":"opencode-squads-803.27","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T17:45:27.946401+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.29","title":"Fix active project propagation across board/mail","description":"Multiple UI areas derive projectId via useProjects() and projects[0], ignoring the active project selected in the sidebar. This causes board/mail (and child components) to fetch and mutate data for the wrong project after a project switch.","design":"Update assets/src/routes/board.tsx and assets/src/routes/mail.tsx to source projectId from useActiveProject() and pass it down. Remove any useProjects()/projects[0] lookups in child components like TicketFlow/ComposeModal.","acceptance_criteria":"- Switching projects updates Board + Mail data without reload\n- No remaining projects[0] selection outside the root provider\n- Queries and SSE subscriptions use activeProject.id","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-31T22:49:01.792927+01:00","updated_at":"2025-12-31T23:14:42.92531+01:00","closed_at":"2025-12-31T23:14:42.92531+01:00","labels":["frontend","projects","ui"],"dependencies":[{"issue_id":"opencode-squads-803.29","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T22:49:01.794253+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.3","title":"Data layer: TanStack Query + API client","description":"API hooks, caching, error handling","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:22:06.445819+01:00","updated_at":"2025-12-31T12:06:45.678848+01:00","closed_at":"2025-12-31T12:06:45.678848+01:00","dependencies":[{"issue_id":"opencode-squads-803.3","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T11:22:06.446288+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.3","depends_on_id":"opencode-squads-803.1","type":"blocks","created_at":"2025-12-31T11:34:52.93872+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.3","depends_on_id":"opencode-squads-w37.8","type":"blocks","created_at":"2025-12-31T11:34:58.120187+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.30","title":"Fix assignee + mail recipient lists (use agents, not squads)","description":"Problem\n- TicketFlow assignee dropdown and Mail compose recipient picker currently call useSquads(projectId) and treat returned Squad[] as people.\n\nEvidence\n- assets/src/components/board/TicketFlow.tsx: renders squad.name values in the Assignee \u003cselect\u003e.\n- assets/src/routes/mail.tsx: ComposeModal toggles recipients using squad.name.\n\nImpact\n- Tickets can only be assigned to squad names (not agents).\n- Mail can be addressed to squad names that backend may not recognize as recipients.","design":"Derive a project-scoped agent list by flattening squads: useSquads(projectId).data?.flatMap(s =\u003e s.agents ?? []). If backend does not preload agents, add an API endpoint + hook to fetch agents. Update assets/src/components/board/TicketFlow.tsx and assets/src/routes/mail.tsx to use the agent list.","acceptance_criteria":"- Assignee dropdown lists agents for the active project\n- Mail compose recipient picker lists agents and sends successfully\n- Ticket.assignee and MailMessage.to use a consistent, documented identifier (likely Agent.name)","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-31T22:51:16.06249+01:00","updated_at":"2025-12-31T23:14:48.108464+01:00","closed_at":"2025-12-31T23:14:48.108464+01:00","labels":["agents","frontend","ui"],"dependencies":[{"issue_id":"opencode-squads-803.30","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T22:51:16.06364+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.31","title":"Agent detail: align session status + mailbox participant filtering","description":"Problem\n- Agent detail uses different session-status logic than the dashboard and likely filters mail threads using the wrong identifier.\n\nEvidence\n- assets/src/routes/index.tsx counts sessions with status == running.\n- assets/src/routes/agent.$agentId.tsx searches for status == active.\n- assets/src/routes/agent.$agentId.tsx filters MailThread.participants using agentId, but MailMessage uses sender_name/to (names), so participants are likely names.\n\nImpact\n- Agent detail can show IDLE/no session even when a session is running.\n- Agent mailbox can appear empty even when there are threads.","design":"Confirm backend session status values and standardize predicates across routes. Decide canonical identifier for mail participants (agent id vs name); update UI filtering accordingly. Prefer real agent data (name/slug/model) over placeholder fallback.","acceptance_criteria":"- Agent detail shows correct ACTIVE/IDLE state based on real sessions\n- Agent mailbox shows threads where the agent participates\n- Session status predicate is consistent across dashboard and agent detail","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T22:51:21.244583+01:00","updated_at":"2025-12-31T23:07:47.882616+01:00","closed_at":"2025-12-31T23:07:47.882616+01:00","labels":["agents","frontend","mail","ui"],"dependencies":[{"issue_id":"opencode-squads-803.31","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T22:51:21.245288+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.32","title":"Mail route: remove window.innerWidth branching; make responsive via CSS/hook","description":"Problem\n- Mail route branches on window.innerWidth during render to decide which panes to show. This is non-reactive (layout will not update on resize) and brittle.\n\nEvidence\n- assets/src/routes/mail.tsx uses (!selectedThreadId || window.innerWidth \u003e= 768) in render logic.\n\nImpact\n- Layout can get stuck when resizing or when opening threads on different viewport sizes.","design":"Refactor assets/src/routes/mail.tsx to rely on Tailwind breakpoints for desktop vs mobile (md:hidden, md:flex) and use state only for mobile navigation. If a hook is preferred, implement a small useMediaQuery that subscribes to matchMedia changes.","acceptance_criteria":"- Resizing viewport updates mail layout without reload\n- No window.innerWidth usage in render\n- Mobile navigation (folders/list/thread) remains predictable and state-driven","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T22:51:26.436196+01:00","updated_at":"2025-12-31T23:07:37.558642+01:00","closed_at":"2025-12-31T23:07:37.558642+01:00","labels":["frontend","mail","responsive","ui"],"dependencies":[{"issue_id":"opencode-squads-803.32","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T22:51:26.436727+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.33","title":"Modal: prevent double onClose and harden \u003cdialog\u003e lifecycle","description":"Problem\n- Modal uses a \u003cdialog\u003e with an effect that calls dialog.close() plus a close event listener that calls onClose. This can double-trigger onClose (especially when parent-driven isOpen changes call dialog.close()). showModal() can also throw if invoked while already open.\n\nEvidence\n- assets/src/components/Modal.tsx: effect toggles showModal/close; separate addEventListener(\"close\", ...) calls onClose.\n\nImpact\n- Duplicate form resets, duplicate notifications, or flickery state when closing modals.","design":"Gate showModal/close using dialog.open and try/catch around showModal. Only call onClose for user actions (ESC/backdrop/close button) or make it idempotent. Prefer dialog onCancel/onClose props over manual addEventListener where possible.","acceptance_criteria":"- onClose fires exactly once per user-initiated close (ESC/backdrop/close button)\n- Parent-driven isOpen changes do not cause duplicate close callbacks\n- No console errors when rapidly opening/closing","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T22:51:31.646501+01:00","updated_at":"2025-12-31T23:07:42.716915+01:00","closed_at":"2025-12-31T23:07:42.716915+01:00","labels":["frontend","modal","ui"],"dependencies":[{"issue_id":"opencode-squads-803.33","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T22:51:31.651627+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.34","title":"Consolidate cn() helper across UI","description":"Problem\n- Multiple cn() helpers exist with different behavior (clsx+twMerge vs simple join), which leads to inconsistent class merging and duplicated code.\n\nEvidence\n- assets/src/routes/__root.tsx defines cn() using clsx + tailwind-merge.\n- assets/src/routes/index.tsx defines a simple join-based cn().\n- assets/src/routes/squad.tsx defines another join-based cn().\n\nImpact\n- Tailwind class conflict resolution differs between screens, making UI changes unpredictable.","design":"Create a shared util (e.g. assets/src/lib/cn.ts) exporting cn(...). Use clsx + twMerge. Replace local helpers with imports. Keep usage consistent across routes and components.","acceptance_criteria":"- Single cn() implementation shared across routes/components\n- No local cn() definitions remain\n- Class merging behavior is consistent (twMerge applied everywhere)","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-31T22:51:36.837304+01:00","updated_at":"2025-12-31T23:14:53.268048+01:00","closed_at":"2025-12-31T23:14:53.268048+01:00","labels":["frontend","refactor","ui"],"dependencies":[{"issue_id":"opencode-squads-803.34","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T22:51:36.838061+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.35","title":"UI animations: configure or replace non-core Tailwind animate classes","description":"Problem\n- Components reference animation utility classes that are not Tailwind core (e.g., animate-in, animate-out, slide-in-from-right-full, fill-mode-forwards). Unless configured, these are no-ops and intended motion feedback is missing.\n\nEvidence\n- assets/src/components/Notifications.tsx uses animate-in/slide-in-from-right-full and animate-out/fade-out.\n- assets/src/components/board/TicketFlow.tsx uses animate-in/fade-in/slide-in-from-right-4.\n\nImpact\n- Toasts and overlays appear abruptly; the UI feels less polished and status feedback is weaker.","design":"Choose one approach: (A) add a Tailwind animation utilities plugin compatible with Tailwind v4, or (B) implement keyframes in assets/src/index.css and replace classnames. Audit all uses of animate-* and slide-in-* utilities.","acceptance_criteria":"- Toasts and overlays animate as intended\n- Animation approach is consistent (plugin vs CSS keyframes)\n- No stray non-configured animation classes remain in the codebase","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-31T22:51:42.026631+01:00","updated_at":"2025-12-31T23:18:55.602691+01:00","closed_at":"2025-12-31T23:18:55.602691+01:00","labels":["frontend","styling","ui"],"dependencies":[{"issue_id":"opencode-squads-803.35","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T22:51:42.027128+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.36","title":"A11y pass: label icon buttons + keyboard dismiss for menus","description":"Problem\n- The UI contains many icon-only buttons and custom dropdown/overlay patterns without explicit aria-labels or keyboard dismissal. This impacts accessibility and can make keyboard navigation frustrating.\n\nEvidence\n- Icon-only buttons: sidebar close, hamburger menu, more menus, dropdown toggles, etc.\n- Many menus use a fixed inset click-catcher div but do not handle Escape or focus management.\n\nImpact\n- Poor screen-reader UX and weak keyboard support across core screens.","design":"Audit key routes (sidebar/nav, squad, board, mail, review) and add aria-labels. Add Escape handlers for dropdowns/menus and ensure focus styles remain visible.","acceptance_criteria":"- Icon-only buttons have aria-labels\n- Escape closes dropdowns/overlays and modals predictably\n- Focus ring and tab order is usable on main screens (sidebar, board, mail, squad)","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-31T22:51:47.217619+01:00","updated_at":"2025-12-31T23:20:42.94784+01:00","closed_at":"2025-12-31T23:20:42.94784+01:00","labels":["a11y","frontend","ui"],"dependencies":[{"issue_id":"opencode-squads-803.36","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T22:51:47.218156+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.38","title":"Create UI for Agent details/editing","description":"Problem\\n- The Agent Details page (assets/src/routes/agent.$agentId.tsx) is currently read-only and uses some fallback/mock data. It lacks the ability to edit agent properties (name, role, model) or manually manage their session state (beyond a placeholder terminate button).\\n\\nEvidence\\n- The page displays agent data but has no 'Edit' button or modal.\\n- The 'Terminate Session' button is visual-only or needs connection to a mutation.\\n\\nImpact\\n- Users cannot update agent configurations or intervene in stuck sessions without dropping to the database or CLI.\\n\\nDesign\\n- Add an 'Edit Agent' button that opens a modal similar to 'CreateAgentModal' but pre-filled.\\n- Implement the 'Terminate Session' button using a useTerminateSession mutation.\\n- Ensure real-time updates for session status.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-31T23:21:13.469112+01:00","updated_at":"2026-01-01T08:41:33.456463+01:00","closed_at":"2026-01-01T08:41:33.456463+01:00","dependencies":[{"issue_id":"opencode-squads-803.38","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T23:21:13.469983+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.4","title":"SSE client + live state updates","description":"Subscribe to backend event stream and patch caches","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:22:11.637423+01:00","updated_at":"2025-12-31T14:13:26.466177+01:00","closed_at":"2025-12-31T14:13:26.466177+01:00","dependencies":[{"issue_id":"opencode-squads-803.4","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T11:22:11.637878+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.4","depends_on_id":"opencode-squads-803.3","type":"blocks","created_at":"2025-12-31T11:35:03.288874+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.5","title":"Squad overview page","description":"Member list, role/status, current ticket/session","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:22:16.822319+01:00","updated_at":"2025-12-31T12:07:42.881933+01:00","closed_at":"2025-12-31T12:07:42.881933+01:00","dependencies":[{"issue_id":"opencode-squads-803.5","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T11:22:16.822812+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.5","depends_on_id":"opencode-squads-803.3","type":"blocks","created_at":"2025-12-31T11:35:08.462542+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.6","title":"Agent detail page (session logs + inbox + worktree)","description":"Agent status, logs, inbox, worktree view","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:22:22.009276+01:00","updated_at":"2025-12-31T14:14:50.313284+01:00","closed_at":"2025-12-31T14:14:50.313284+01:00","dependencies":[{"issue_id":"opencode-squads-803.6","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T11:22:22.009777+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.6","depends_on_id":"opencode-squads-803.3","type":"blocks","created_at":"2025-12-31T11:35:13.635685+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.7","title":"Ticket board page","description":"Ready/in-progress/blocked view with Beads IDs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:22:27.192827+01:00","updated_at":"2025-12-31T14:13:00.984777+01:00","closed_at":"2025-12-31T14:13:00.984777+01:00","dependencies":[{"issue_id":"opencode-squads-803.7","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T11:22:27.193311+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.7","depends_on_id":"opencode-squads-803.3","type":"blocks","created_at":"2025-12-31T11:35:18.800973+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.7","depends_on_id":"opencode-squads-5mr.3","type":"blocks","created_at":"2025-12-31T11:35:23.960353+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.8","title":"Review queue page","description":"PR summaries, approve/request changes actions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:22:32.373563+01:00","updated_at":"2025-12-31T14:00:48.724771+01:00","closed_at":"2025-12-31T14:00:48.724771+01:00","dependencies":[{"issue_id":"opencode-squads-803.8","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T11:22:32.374056+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.8","depends_on_id":"opencode-squads-803.3","type":"blocks","created_at":"2025-12-31T11:35:29.123777+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.8","depends_on_id":"opencode-squads-hrj.3","type":"blocks","created_at":"2025-12-31T11:35:34.291695+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.8","depends_on_id":"opencode-squads-hrj.4","type":"blocks","created_at":"2025-12-31T11:35:39.461522+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-803.9","title":"Mail UI components (inbox/thread/compose)","description":"Thread list, message view, compose modal","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:22:37.55852+01:00","updated_at":"2025-12-31T14:03:04.343513+01:00","closed_at":"2025-12-31T14:03:04.343513+01:00","dependencies":[{"issue_id":"opencode-squads-803.9","depends_on_id":"opencode-squads-803","type":"parent-child","created_at":"2025-12-31T11:22:37.559023+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.9","depends_on_id":"opencode-squads-803.3","type":"blocks","created_at":"2025-12-31T11:35:44.633735+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-803.9","depends_on_id":"opencode-squads-7ug.2","type":"blocks","created_at":"2025-12-31T11:35:49.808355+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-823","title":"Mail cc/bcc recipient_type lost","description":"send_message in lib/squads/mail.ex:114 builds recipients from to/cc/bcc but ids are inserted without recipient_type, so cc/bcc recipients are stored as to (default in lib/squads/mail/recipient.ex:14). Set recipient_type by list or require map with type.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T17:56:14.256424+01:00","updated_at":"2025-12-31T18:05:53.117536+01:00","closed_at":"2025-12-31T18:05:53.117536+01:00"}
{"id":"opencode-squads-864","title":"Reservation overlap ignores glob semantics","description":"patterns_overlap? in lib/squads/reservations.ex:117 uses String.contains which ignores glob semantics, so overlaps like src/**/*.ex vs src/foo.ex are missed and conflicting reservations can pass. Use fnmatch or Path.wildcard matching.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T17:56:03.882556+01:00","updated_at":"2025-12-31T18:05:42.838794+01:00","closed_at":"2025-12-31T18:05:42.838794+01:00"}
{"id":"opencode-squads-87m","title":"MCP agent_mail connect returns 406 and zlib decompression errors","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T17:05:23.58185+01:00","updated_at":"2026-01-05T09:45:27.61999+01:00","closed_at":"2026-01-05T09:45:27.61999+01:00"}
{"id":"opencode-squads-8c5","title":"Session chat flyout from sessions list","description":"Add a chat icon per session row that opens a right-side flyout showing session chat with polling and a composer. Include header (agent name, status, session id) and close/ESC behavior; use the same message renderer as existing chat.","acceptance_criteria":"Clicking the chat icon opens the flyout; messages load and update; sending prompts works; flyout closes via close button or ESC without navigation.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-01T13:56:27.215139+01:00","updated_at":"2026-01-01T14:29:19.647955+01:00","closed_at":"2026-01-01T14:29:19.647955+01:00"}
{"id":"opencode-squads-8fl","title":"Implement Global Command Palette (Cmd+K)","description":"Add a keyboard-driven command interface for quick navigation and actions, styled like a terminal prompt.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T20:51:16.311906+01:00","updated_at":"2026-01-01T21:05:50.855838+01:00","closed_at":"2026-01-01T21:05:50.855838+01:00"}
{"id":"opencode-squads-8kr","title":"OpenCode process exits but server still reachable (zombie)","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T17:05:28.769026+01:00","updated_at":"2026-01-05T09:45:32.77326+01:00","closed_at":"2026-01-05T09:45:32.77326+01:00"}
{"id":"opencode-squads-9el","title":"Project-specific OpenCode server orchestration","description":"Currently, opencode-squads relies on a single global OpenCode server (likely started manually in a specific directory). We should implement project-specific server orchestration where each project starts its own OpenCode instance on a random port. This ensures strict directory isolation and allows multiple projects to run sessions simultaneously without state pollution.","acceptance_criteria":"1. Phoenix starts an opencode process per project when needed. 2. Port is dynamically allocated. 3. Sessions for project A use project A's server. 4. Server is terminated when no longer needed or on project shutdown.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T16:00:39.207054+01:00","updated_at":"2026-01-01T17:44:58.006381+01:00","closed_at":"2026-01-01T17:44:58.006381+01:00"}
{"id":"opencode-squads-9p0","title":"Expand MCP API endpoints","description":"Reference: docs/prd-mcp-agents.md (API section).\n\nExpand SquadsWeb.API.MCPController to support squad-scoped CRUD and catalog browsing. Implement: GET /api/mcp?squad_id=..., POST /api/mcp (create), PATCH /api/mcp/:name (update), POST /api/mcp/:name/connect (enable), POST /api/mcp/:name/disconnect (disable), GET /api/mcp/catalog (catalog list). Add JSON rendering with consistent response shape and error handling for missing squad_id.","acceptance_criteria":"- Endpoints respond with consistent JSON shape.\n- Missing squad_id returns 400 with clear error.\n- Connect and disconnect update DB and return status.\n- Catalog endpoint returns cached list.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T21:48:47.067469+01:00","updated_at":"2026-01-02T21:48:47.067469+01:00"}
{"id":"opencode-squads-9qn","title":"Add escalation support to agent_mail MCP","description":"","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-31T21:20:34.481425+01:00","updated_at":"2025-12-31T22:28:47.269265+01:00","closed_at":"2025-12-31T22:28:47.269265+01:00","dependencies":[{"issue_id":"opencode-squads-9qn","depends_on_id":"opencode-squads-zcp","type":"blocks","created_at":"2025-12-31T21:20:34.482681+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-9zo","title":"Improve Backend Test Coverage","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:47:38.489364+01:00","updated_at":"2026-01-02T17:10:41.165239+01:00","closed_at":"2026-01-02T17:10:41.165239+01:00"}
{"id":"opencode-squads-9zo.11","title":"Implement MCP tests","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:51:35.758011+01:00","updated_at":"2026-01-02T11:52:14.225761+01:00","closed_at":"2026-01-02T11:52:14.225761+01:00","dependencies":[{"issue_id":"opencode-squads-9zo.11","depends_on_id":"opencode-squads-9zo","type":"parent-child","created_at":"2026-01-02T11:51:35.75873+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-9zo.12","title":"Implement ProviderController tests","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:52:21.151131+01:00","updated_at":"2026-01-02T11:53:03.446647+01:00","closed_at":"2026-01-02T11:53:03.446647+01:00","dependencies":[{"issue_id":"opencode-squads-9zo.12","depends_on_id":"opencode-squads-9zo","type":"parent-child","created_at":"2026-01-02T11:52:21.151675+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-9zo.13","title":"Implement WorktreeController tests","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:53:10.316089+01:00","updated_at":"2026-01-02T11:53:32.136642+01:00","closed_at":"2026-01-02T11:53:32.136642+01:00","dependencies":[{"issue_id":"opencode-squads-9zo.13","depends_on_id":"opencode-squads-9zo","type":"parent-child","created_at":"2026-01-02T11:53:10.316707+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-9zo.3","title":"Implement AgentController tests","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:48:09.349754+01:00","updated_at":"2026-01-02T11:49:19.637087+01:00","closed_at":"2026-01-02T11:49:19.637087+01:00","dependencies":[{"issue_id":"opencode-squads-9zo.3","depends_on_id":"opencode-squads-9zo","type":"parent-child","created_at":"2026-01-02T11:48:09.35046+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-9zo.4","title":"Implement EventController tests","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:48:14.521778+01:00","updated_at":"2026-01-02T11:50:20.041185+01:00","closed_at":"2026-01-02T11:50:20.041185+01:00","dependencies":[{"issue_id":"opencode-squads-9zo.4","depends_on_id":"opencode-squads-9zo","type":"parent-child","created_at":"2026-01-02T11:48:14.522318+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-9zo.5","title":"Implement Filesystem tests","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:48:19.677102+01:00","updated_at":"2026-01-02T11:51:15.726732+01:00","closed_at":"2026-01-02T11:51:15.726732+01:00","dependencies":[{"issue_id":"opencode-squads-9zo.5","depends_on_id":"opencode-squads-9zo","type":"parent-child","created_at":"2026-01-02T11:48:19.677794+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-9zo.6","title":"Implement MCP tests","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:48:24.845811+01:00","updated_at":"2026-01-02T17:08:58.526738+01:00","closed_at":"2026-01-02T17:08:58.526738+01:00","dependencies":[{"issue_id":"opencode-squads-9zo.6","depends_on_id":"opencode-squads-9zo","type":"parent-child","created_at":"2026-01-02T11:48:24.846472+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-9zo.7","title":"Implement ProviderController tests","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:48:30.014716+01:00","updated_at":"2026-01-02T17:09:54.534906+01:00","closed_at":"2026-01-02T17:09:54.534906+01:00","dependencies":[{"issue_id":"opencode-squads-9zo.7","depends_on_id":"opencode-squads-9zo","type":"parent-child","created_at":"2026-01-02T11:48:30.015525+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-9zo.8","title":"Implement WorktreeController tests","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:48:35.182722+01:00","updated_at":"2026-01-02T17:10:33.086547+01:00","closed_at":"2026-01-02T17:10:33.086547+01:00","dependencies":[{"issue_id":"opencode-squads-9zo.8","depends_on_id":"opencode-squads-9zo","type":"parent-child","created_at":"2026-01-02T11:48:35.183306+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-a38","title":"Add Visual Feedback for SSE Connection Failures","description":"","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T20:51:01.673923+01:00","updated_at":"2026-01-01T20:57:06.964413+01:00","closed_at":"2026-01-01T20:57:06.964413+01:00"}
{"id":"opencode-squads-a7r","title":"Auto-rebuild frontend assets on change during development","description":"## Problem\n\nCurrently, frontend asset changes (React/TypeScript in assets/src/) require a manual `npm run build` to update priv/static/assets/. Phoenix's live_reload watches priv/static/ but Vite dev server serves from memory, not disk.\n\n## Current Setup\n- `config/dev.exs` runs `npm run dev` which starts Vite dev server (port 5173)\n- Vite dev server proxies /api to Phoenix (port 4000)\n- Phoenix serves SPA from priv/static/assets/ (built by `npm run build`)\n- Phoenix live_reload watches priv/static/*.js|css\n\n## The Gap\nWhen code changes in assets/src/:\n- Vite dev server at :5173 picks up changes immediately (HMR)\n- BUT Phoenix at :4000 serves stale priv/static/ assets\n- Developers accessing :4000 see old code until manual rebuild\n\n## Solutions (Pick One)\n\n### Option A: Use vite build --watch (Recommended)\nChange `npm run dev` to run `vite build --watch` which continuously rebuilds to priv/static/:\n\n```json\n// assets/package.json\n\"scripts\": {\n  \"dev\": \"vite build --watch\",\n  ...\n}\n```\n\nPros: Simple, works with Phoenix live_reload, one port (:4000)\nCons: Slower rebuilds than HMR, no HMR\n\n### Option B: Configure Phoenix to serve Vite dev assets\nIn dev, have Phoenix proxy to Vite for assets. Complex but enables HMR.\n\n### Option C: Document the two-server workflow\nKeep current setup, document that developers should access :5173 for frontend work.\n\n## Acceptance Criteria\n- [ ] Asset changes reflected in browser within seconds during development\n- [ ] Single command (mix phx.server) starts everything needed\n- [ ] Works reliably without manual intervention","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T11:44:29.784149+01:00","updated_at":"2026-01-01T12:03:01.5675+01:00","closed_at":"2026-01-01T12:03:01.5675+01:00"}
{"id":"opencode-squads-apx","title":"(Optional) Persist pinned external nodes","description":"Idea\n- Allow users to \"pin\" external nodes so they remain in the UI even if auto-discovery is transient. Useful when configured endpoints are static but we still want UI management.\n\nWork\n- Add a persisted store (DB table or config) for pinned nodes: base_url, label, notes, allowlisted flag.\n- Merge pinned nodes into discovery results.\n- UI: add/remove pin, edit label.\n","acceptance_criteria":"- I can pin an external node by URL and it appears in the node list on reload.\n- Pinned nodes merge with auto-discovered nodes (no duplicates).\n","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-02T10:11:33.852141+01:00","updated_at":"2026-01-02T10:11:33.852141+01:00","labels":["backend","discovery","frontend"],"dependencies":[{"issue_id":"opencode-squads-apx","depends_on_id":"opencode-squads-oz5","type":"discovered-from","created_at":"2026-01-02T10:11:33.853582+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-arx","title":"Incorrect agent mail MCP URL in project provisioning","description":"Projects were being provisioned with an incorrect agent mail MCP URL (127.0.0.1:8765 instead of the squads-hosted MCP at 127.0.0.1:4000/api/mcp/agent_mail/connect). This blocked agent mail functionality in provisioned projects.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T21:42:18.388162+01:00","updated_at":"2026-01-02T21:42:25.455132+01:00","closed_at":"2026-01-02T21:42:25.455132+01:00"}
{"id":"opencode-squads-avx","title":"Implement Agent Chat UI","description":"Add a chat interface to the agent details page to interact with a running session. It should display messages and allow sending prompts via POST /api/sessions/:id/prompt.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-01T11:38:40.755207+01:00","updated_at":"2026-01-01T12:51:58.528454+01:00","closed_at":"2026-01-01T12:51:58.528454+01:00"}
{"id":"opencode-squads-awp","title":"Frontend: Ticket Board filter by status/assignee","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T18:51:38.173332+01:00","updated_at":"2025-12-31T18:53:12.855674+01:00","closed_at":"2025-12-31T18:53:12.855674+01:00","dependencies":[{"issue_id":"opencode-squads-awp","depends_on_id":"opencode-squads-803.7","type":"discovered-from","created_at":"2025-12-31T18:51:38.174177+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-az8","title":"Fix Agents Navigation (404)","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-01T20:50:46.144863+01:00","updated_at":"2026-01-01T20:56:35.05255+01:00","closed_at":"2026-01-01T20:56:35.05255+01:00"}
{"id":"opencode-squads-b9x","title":"Worktree creation assumes master","description":"create_worktree in lib/squads/worktrees.ex:34 always uses master as base branch, which fails on repos whose default branch is main or custom. Detect default branch or accept it as config.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T17:56:09.077027+01:00","updated_at":"2025-12-31T18:05:47.975646+01:00","closed_at":"2025-12-31T18:05:47.975646+01:00"}
{"id":"opencode-squads-boe","title":"Enable starting/stopping agents from Squads view","description":"Currently, clicking an agent in the Squads view redirects to the agent registry where no operations are available. Users need the ability to start and stop agents directly from the Squads view. When an agent is started, it should show the chat button and other actions.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-02T08:33:56.545951+01:00","updated_at":"2026-01-02T08:35:56.172323+01:00","closed_at":"2026-01-02T08:35:56.172323+01:00"}
{"id":"opencode-squads-boj","title":"JSONC comment stripping breaks URLs","description":"strip_jsonc_comments in lib/squads/opencode/config.ex:315 removes // sequences inside string values, so urls like http://localhost get truncated and JSON parse fails. Use a JSONC parser or a comment stripper that skips strings.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T17:55:58.687102+01:00","updated_at":"2025-12-31T18:05:37.697133+01:00","closed_at":"2025-12-31T18:05:37.697133+01:00"}
{"id":"opencode-squads-cl7","title":"Visualize Squad Network Graph","description":"Interactive node-link diagram showing relationships between squads and projects using @xyflow/react.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-01T20:51:26.661836+01:00","updated_at":"2026-01-05T10:12:45.468842+01:00","closed_at":"2026-01-05T10:12:45.468842+01:00"}
{"id":"opencode-squads-cqa","title":"UI: Fleet dashboard (global squads + connections)","description":"Work\n- Add a Fleet route/view that shows:\n  - all projects\n  - squads per project\n  - existing connections between squads\n- Provide UX to create/remove connections (search + select squads).\n- Provide an entry in nav + command palette.\n\nNotes\n- Fleet can reuse (or replace) the planned \"squad network graph\" visualization as a later enhancement.\n","acceptance_criteria":"- I can open Fleet and see all squads grouped by project.\n- I can connect two squads and see the connection reflected immediately.\n- I can remove a connection.\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-02T10:12:32.322205+01:00","updated_at":"2026-01-02T17:38:49.943521+01:00","closed_at":"2026-01-02T17:38:49.943521+01:00","labels":["fleet","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-cqa","depends_on_id":"opencode-squads-5b0","type":"blocks","created_at":"2026-01-02T10:12:32.324391+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-crj","title":"Enable sending email as the human user","description":"Users currently can only send emails as an agent. The UI and backend should allow the human user to send emails identifying as themselves.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T13:16:29.208275+01:00","updated_at":"2026-01-01T14:24:13.616202+01:00","closed_at":"2026-01-01T14:24:13.616202+01:00"}
{"id":"opencode-squads-d2t","title":"Consolidate realtime architecture (SSE + WS + polling duplication)","description":"Problem\n- The frontend currently mixes multiple realtime mechanisms:\n  - SSE in the app shell for project events (assets/src/routes/__root.tsx).\n  - WebSocket subscriptions via useProjectEvents in chat + terminal panel (assets/src/lib/socket.ts, assets/src/components/SessionChat.tsx, assets/src/components/TerminalPanel.tsx).\n  - Polling for session messages (assets/src/components/SessionChat.tsx uses refetchInterval).\n\nImpact\n- Duplicate network traffic and inconsistent invalidation behavior.\n- Harder to reason about correctness (some views refresh, others do not).\n- More edge cases around reconnect/backoff and resource cleanup.\n\nSuggested approach\n- Decide on a single primary realtime strategy for events + session updates:\n  - Option A: SSE for all events (with typed kinds) and use React Query invalidation everywhere.\n  - Option B: WebSocket for session-level streaming + SSE for audit/event timeline (no polling).\n- Remove redundant polling once realtime invalidations are reliable.\n- Document the chosen approach and required event kinds/payloads.\n\nNotes\n- This epic should likely be addressed after fixing the individual correctness bugs (SSE reconnect, kind naming, cache keys).\n","acceptance_criteria":"- Exactly one primary realtime mechanism is used for session/message updates (no duplicate polling + WS + SSE for the same data).\n- Reconnect/backoff is reliable and consistent across the app.\n- Events + board + chat stay in sync under normal use and after reconnects.\n","status":"open","priority":4,"issue_type":"epic","created_at":"2026-01-02T17:40:57.303303+01:00","updated_at":"2026-01-02T17:40:57.303303+01:00","labels":["assets","frontend","performance","realtime"],"dependencies":[{"issue_id":"opencode-squads-d2t","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T17:40:57.305965+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-deu","title":"Pressing diff view in chat UI crashes","description":"The SessionDiff component in assets/src/routes/agent.$agentId.tsx crashes because it calls .trim() on the diff data without verifying it is a string. If the API returns an object or null, it throws 'f.trim is not a function'. This was discovered when pressing the diff view in the chat UI.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T20:20:47.684944+01:00","updated_at":"2026-01-02T20:21:41.57918+01:00","closed_at":"2026-01-02T20:21:41.57918+01:00","dependencies":[{"issue_id":"opencode-squads-deu","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T20:20:47.685972+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-dop","title":"Slash command /sessions returns 502","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T17:05:13.2026+01:00","updated_at":"2026-01-05T09:27:38.800868+01:00","closed_at":"2026-01-05T09:27:38.800868+01:00"}
{"id":"opencode-squads-dvo","title":"Unify API base URL config across fetch/SSE/WebSocket","description":"Problem\n- Different network layers use different base URL derivations:\n  - fetcher hardcodes API_BASE = \"/api\" (assets/src/api/client.ts:1).\n  - SSE uses VITE_API_URL || \"/api\" (assets/src/routes/__root.tsx:82).\n  - WebSocket uses window.location.host with a fixed path (assets/src/lib/socket.ts:38-41).\n\nImpact\n- Running the frontend against a non-default backend origin/base path can partially break (e.g., SSE works but fetch calls do not, or WS does not).\n- Harder to deploy behind proxies or in multi-node setups.\n\nSuggested fix\n- Centralize base URL configuration in one place (e.g., a shared config module):\n  - Prefer VITE_API_URL for HTTP + SSE (with a safe default).\n  - Consider VITE_WS_URL or derive WS URL from the API base consistently.\n- Update fetcher + SSE + websocket hook to use this shared config.\n- Document expected env vars in assets/README or existing docs.\n","acceptance_criteria":"- Setting VITE_API_URL routes both fetcher and SSE to the same backend.\n- WebSocket URL selection is consistent and configurable for non-local deployments.\n","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-02T17:40:28.984502+01:00","updated_at":"2026-01-02T19:30:45.142182+01:00","closed_at":"2026-01-02T19:30:45.142182+01:00","labels":["assets","config","frontend","realtime"],"dependencies":[{"issue_id":"opencode-squads-dvo","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T17:40:28.986002+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-dwm","title":"Frontend: Add SSE connection status indicator to TopBar","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-31T18:51:33.015201+01:00","updated_at":"2025-12-31T18:53:02.563109+01:00","closed_at":"2025-12-31T18:53:02.563109+01:00","dependencies":[{"issue_id":"opencode-squads-dwm","depends_on_id":"opencode-squads-803.4","type":"discovered-from","created_at":"2025-12-31T18:51:33.016067+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-dws","title":"UX: typography + naming pass (reduce ALL_CAPS noise)","description":"Context\n- Many user-facing surfaces use ALL_CAPS + underscores (e.g., ACTIVE_SESSIONS, NO_ACTIVE_SESSIONS, EVENT_LOG), which adds visual noise and makes the app feel more cluttered than it is.\n\nGoal\n- Keep the terminal aesthetic while improving readability and hierarchy via typography and copy.\n","acceptance_criteria":"- Primary headings use readable casing (sentence/title) while preserving stylistic accents.\n- Empty-state copy is concise and user-oriented.\n- Contrast and spacing support scanning on dark theme.\n","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-02T17:56:30.983189+01:00","updated_at":"2026-01-02T17:56:30.983189+01:00","labels":["assets","design","frontend","ux"]}
{"id":"opencode-squads-dws.1","title":"Copy pass: replace ALL_CAPS/underscores in user-facing labels","description":"Work\n- Identify UI strings that are user-facing (headings, empty states, buttons) and overly stylized (ALL_CAPS + underscores).\n- Convert to readable casing while keeping the brand/terminal feel via font/weight, not punctuation.\n","acceptance_criteria":"- User-facing headings/buttons use readable casing consistently.\n- Internal/debug strings remain unchanged where appropriate.\n","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-02T17:56:47.531892+01:00","updated_at":"2026-01-02T17:56:47.531892+01:00","labels":["assets","design","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-dws.1","depends_on_id":"opencode-squads-dws","type":"parent-child","created_at":"2026-01-02T17:56:47.53262+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-dws.2","title":"Typography: tighten hierarchy + spacing on dark theme","description":"Work\n- Review heading sizes, line heights, and spacing to improve scanning in the dark theme.\n- Ensure primary actions stand out without relying on large blocks/boxes.\n","acceptance_criteria":"- Visual hierarchy is clearer (title â†’ subtitle â†’ content).\n- Reduced perceived clutter without removing information.\n","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-02T17:57:06.354019+01:00","updated_at":"2026-01-02T17:57:06.354019+01:00","labels":["assets","design","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-dws.2","depends_on_id":"opencode-squads-dws","type":"parent-child","created_at":"2026-01-02T17:57:06.354728+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-dws.3","title":"Visual polish: contrast + border weight audit","description":"Problem\n- The UI uses many thin borders and low-contrast text; combined with blur/glow, it can feel hazy and crowded.\n\nWork\n- Audit contrast ratios for primary/secondary text.\n- Adjust border weights and backgrounds to reduce visual noise while preserving the aesthetic.\n","acceptance_criteria":"- Body text and key labels are comfortably readable.\n- Borders/dividers guide layout without making the UI feel boxed-in.\n","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-02T17:57:23.244471+01:00","updated_at":"2026-01-02T17:57:23.244471+01:00","labels":["assets","design","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-dws.3","depends_on_id":"opencode-squads-dws","type":"parent-child","created_at":"2026-01-02T17:57:23.245305+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-dyc","title":"Refine Typography: Reduce All-Caps Usage","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-01T20:50:56.511679+01:00","updated_at":"2026-01-01T21:06:43.189771+01:00","closed_at":"2026-01-01T21:06:43.189771+01:00"}
{"id":"opencode-squads-e24","title":"Frontend sessions query: support agent_id + status filters","description":"Context\n- Backend already supports GET /api/sessions?agent_id=... and ?status=... (SessionController.index).\n- Frontend currently uses a single useSessions() hook that always fetches /sessions with no filtering and the UI filters locally to active statuses only.\n\nWork\n- Extend the frontend query layer to support server-side filtering: agent_id and status and/or a \"scope\" (active/history/all).\n- Ensure react-query keys include filter params so caches don't collide.\n- Update consuming pages (agent, sessions) to use the filtered hooks instead of global fetch + local filtering.\n","acceptance_criteria":"- Frontend can fetch sessions by agent_id and by status without manual client-side filtering.\n- React Query caches are keyed by filter params (no stale cross-talk).\n- Sessions page can request Active vs History vs All using these hooks.\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T10:07:42.77053+01:00","updated_at":"2026-01-02T12:31:21.605147+01:00","closed_at":"2026-01-02T12:31:21.605147+01:00","labels":["api","frontend","sessions"],"dependencies":[{"issue_id":"opencode-squads-e24","depends_on_id":"opencode-squads-v3q","type":"blocks","created_at":"2026-01-02T10:07:42.772065+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-e5h","title":"Create Interactive 'Boot Sequence' Onboarding","description":"Gamified tutorial disguised as a system initialization sequence to teach users the terminology and navigation.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-01T20:54:52.168475+01:00","updated_at":"2026-01-02T08:44:56.551576+01:00","closed_at":"2026-01-02T08:44:56.551576+01:00"}
{"id":"opencode-squads-eil","title":"Fix FunctionClauseError in Squads.Events.list_events_for_agent","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-01T08:02:11.658881+01:00","updated_at":"2026-01-01T08:04:39.942481+01:00","closed_at":"2026-01-01T08:04:39.942481+01:00"}
{"id":"opencode-squads-f2j","title":"Sessions page crashes: hooks-in-loop when loading squads","description":"Problem\n- assets/src/routes/sessions.tsx defines a SquadsFetcher component that calls useSquads(projectId) inside a for-loop.\n- This violates the Rules of Hooks (hook calls must be unconditional and in consistent order).\n\nWhere\n- assets/src/routes/sessions.tsx:56 (SquadsFetcher)\n- assets/src/routes/sessions.tsx:60-70 (loop calling useSquads)\n\nImpact\n- Runtime crash: \"Rendered fewer hooks than expected\" when projects list changes or initial load re-renders.\n- Sessions grouping by squad/project can be incomplete or stale.\n\nSuggested fix\nOption A (preferred): use useQueries from @tanstack/react-query to fetch squads per project (one hook call).\n- Build an array of query configs from projects.\n- Derive allSquads + agentLookup with useMemo from query results.\n- Avoid setState during render.\n\nOption B: add a backend endpoint to fetch squads across multiple projects in one call.\n\nNotes\n- Avoid setting state based on query results inside the render path; derive from data instead.\n","acceptance_criteria":"- Sessions page never triggers hook-order errors when projects change.\n- Sessions are grouped correctly across projects/squads.\n- Loading/empty states behave correctly with 0, 1, or many projects.\n","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-02T17:38:48.77277+01:00","updated_at":"2026-01-02T19:12:05.338804+01:00","closed_at":"2026-01-02T19:12:05.338804+01:00","labels":["assets","frontend","react","react-query","sessions"],"dependencies":[{"issue_id":"opencode-squads-f2j","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T17:38:48.774718+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-f3a","title":"Verify Ticket Creation and Agent Awareness","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T10:21:51.567174+01:00","updated_at":"2026-01-01T10:25:50.114164+01:00","closed_at":"2026-01-01T10:25:50.114164+01:00"}
{"id":"opencode-squads-fcm","title":"Debug slash commands (500 error)","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T12:06:03.544368+01:00","updated_at":"2026-01-02T12:06:54.049928+01:00","closed_at":"2026-01-02T12:06:54.049928+01:00","dependencies":[{"issue_id":"opencode-squads-fcm","depends_on_id":"opencode-squads-0i6","type":"discovered-from","created_at":"2026-01-02T12:06:03.545401+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-g1k","title":"Agent detail: Todos/Diff tabs broken (double data unwrapping)","description":"Problem\n- fetcher() already unwraps { data: ... } API responses (assets/src/api/client.ts:57).\n- useSessionTodos and useSessionDiff unwrap again via `.then(res =\u003e res.data)`, causing undefined results or runtime errors.\n\nWhere\n- assets/src/api/client.ts:57 (unwrap logic)\n- assets/src/api/queries.ts:503-508 (useSessionTodos)\n- assets/src/api/queries.ts:511-516 (useSessionDiff)\n- assets/src/routes/agent.$agentId.tsx:58 (SessionTodos UI)\n\nImpact\n- Agent detail tabs TODOS and DIFF show empty/error states even when backend returns data.\n\nSuggested fix\n- Make hooks match fetcher() behavior:\n  - useSessionTodos: `fetcher\u003cany[]\u003e(...)` and return the array directly.\n  - useSessionDiff: `fetcher\u003cstring\u003e(...)` and return the string directly.\n- Ensure the UI handles empty array/empty string correctly.\n","acceptance_criteria":"- TODOS tab renders actual todo items returned by the backend.\n- DIFF tab renders the diff string returned by the backend.\n- No undefined `.data` access remains in these hooks.\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T17:39:29.684657+01:00","updated_at":"2026-01-02T19:18:04.909407+01:00","closed_at":"2026-01-02T19:18:04.909407+01:00","labels":["agents","assets","frontend","react-query","sessions"],"dependencies":[{"issue_id":"opencode-squads-g1k","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T17:39:29.686526+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-gfh","title":"Temp disable plan/build agent in OpenCode requests","description":"","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-04T21:55:30.513274+01:00","updated_at":"2026-01-05T09:48:14.918967+01:00","closed_at":"2026-01-05T09:48:14.918967+01:00"}
{"id":"opencode-squads-grc","title":"OpenCode integration + session orchestration","description":"HTTP client, session lifecycle, SSE ingestion, model/provider discovery","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-31T11:16:23.923764+01:00","updated_at":"2025-12-31T14:12:21.713703+01:00","closed_at":"2025-12-31T14:12:21.713703+01:00","dependencies":[{"issue_id":"opencode-squads-grc","depends_on_id":"opencode-squads-w37","type":"blocks","created_at":"2025-12-31T11:30:12.67504+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-grc.1","title":"Implement OpenCode HTTP client wrapper","description":"HTTP client for OpenCode server, base URL, headers, retries","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T11:19:09.610928+01:00","updated_at":"2025-12-31T13:37:55.574696+01:00","closed_at":"2025-12-31T13:37:55.574696+01:00","dependencies":[{"issue_id":"opencode-squads-grc.1","depends_on_id":"opencode-squads-grc","type":"parent-child","created_at":"2025-12-31T11:19:09.611422+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-grc.1","depends_on_id":"opencode-squads-w37.3","type":"blocks","created_at":"2025-12-31T11:31:19.845714+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-grc.2","title":"Session lifecycle endpoints (create/list/stop)","description":"API to start, list, stop sessions mapped to agents","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T11:19:14.809858+01:00","updated_at":"2025-12-31T13:46:26.047997+01:00","closed_at":"2025-12-31T13:46:26.047997+01:00","dependencies":[{"issue_id":"opencode-squads-grc.2","depends_on_id":"opencode-squads-grc","type":"parent-child","created_at":"2025-12-31T11:19:14.810722+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-grc.2","depends_on_id":"opencode-squads-grc.1","type":"blocks","created_at":"2025-12-31T11:31:25.016214+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-grc.2","depends_on_id":"opencode-squads-w37.4","type":"blocks","created_at":"2025-12-31T11:31:30.181564+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-grc.3","title":"SSE ingestion for session + global events","description":"Subscribe to /event and /session/:id/event, persist logs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:19:20.006966+01:00","updated_at":"2025-12-31T13:57:10.316125+01:00","closed_at":"2025-12-31T13:57:10.316125+01:00","dependencies":[{"issue_id":"opencode-squads-grc.3","depends_on_id":"opencode-squads-grc","type":"parent-child","created_at":"2025-12-31T11:19:20.007528+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-grc.3","depends_on_id":"opencode-squads-grc.1","type":"blocks","created_at":"2025-12-31T11:31:35.356062+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-grc.3","depends_on_id":"opencode-squads-w37.4","type":"blocks","created_at":"2025-12-31T11:31:40.532745+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-grc.4","title":"Model/provider discovery via server endpoints","description":"Call /config, /config/providers, /provider and store snapshot","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:19:25.192375+01:00","updated_at":"2025-12-31T14:01:54.815429+01:00","closed_at":"2025-12-31T14:01:54.815429+01:00","dependencies":[{"issue_id":"opencode-squads-grc.4","depends_on_id":"opencode-squads-grc","type":"parent-child","created_at":"2025-12-31T11:19:25.192835+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-grc.4","depends_on_id":"opencode-squads-grc.1","type":"blocks","created_at":"2025-12-31T11:31:45.711755+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-grc.5","title":"Config fallback: parse OpenCode config files + env","description":"Merge global + project config and env overrides when server not reachable","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:19:30.369133+01:00","updated_at":"2025-12-31T14:08:16.700863+01:00","closed_at":"2025-12-31T14:08:16.700863+01:00","dependencies":[{"issue_id":"opencode-squads-grc.5","depends_on_id":"opencode-squads-grc","type":"parent-child","created_at":"2025-12-31T11:19:30.369642+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-grc.5","depends_on_id":"opencode-squads-grc.1","type":"blocks","created_at":"2025-12-31T11:31:50.880411+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-grc.6","title":"Dispatch commands/messages to sessions","description":"Send prompts/commands to OpenCode sessions via HTTP","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:19:35.554459+01:00","updated_at":"2025-12-31T14:12:01.272944+01:00","closed_at":"2025-12-31T14:12:01.272944+01:00","dependencies":[{"issue_id":"opencode-squads-grc.6","depends_on_id":"opencode-squads-grc","type":"parent-child","created_at":"2025-12-31T11:19:35.554965+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-grc.6","depends_on_id":"opencode-squads-grc.1","type":"blocks","created_at":"2025-12-31T11:31:56.047423+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-grc.6","depends_on_id":"opencode-squads-grc.2","type":"blocks","created_at":"2025-12-31T11:32:01.228216+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-gv0","title":"Implement MCP secrets configuration","description":"Reference: docs/prd-mcp-agents.md (Authorization and Secrets).\n\nAdd backend support for MCP secrets required by catalog metadata. Parse catalog_meta.config.secrets and expose via API. Implement DockerCLI wrappers for docker mcp secret commands and context functions to store/validate secret presence per server. Provide API endpoint to set/update secrets (store only references or proxy to docker CLI).","acceptance_criteria":"- Secrets metadata exposed in MCP API responses.\n- Context supports set/validate secrets per server.\n- CLI wrapper covers docker mcp secret operations.\n- Tests stub CLI and cover error paths.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T22:39:09.017514+01:00","updated_at":"2026-01-02T22:39:09.017514+01:00"}
{"id":"opencode-squads-gwm","title":"Add OpenCode config creation/init for projects","description":"","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-31T20:31:20.124949+01:00","updated_at":"2025-12-31T20:34:31.378059+01:00","closed_at":"2025-12-31T20:34:31.378059+01:00"}
{"id":"opencode-squads-h4i","title":"Event kinds mapping drops status/tool events","description":"EventIngester maps session.updated to session.status_changed and tool.start/end to session.tool_started/session.tool_completed (lib/squads/opencode/event_ingester.ex:38-85). These kinds are not in Squads.Events.Event.kinds (lib/squads/events/event.ex:18), so persist_event skips them. Add kinds or map to existing ones.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T17:55:48.323842+01:00","updated_at":"2025-12-31T18:05:32.552084+01:00","closed_at":"2025-12-31T18:05:32.552084+01:00"}
{"id":"opencode-squads-h8j","title":"Extract SSE stream loop from EventController","description":"Problem:\n- EventController owns SSE handshake, chunk formatting, and the receive loop.\n- Streaming behavior is harder to test and reuse when embedded in the controller.\n\nProposal:\n- Introduce a dedicated module (SquadsWeb.EventStream or Squads.Events.Streamer) that manages stream setup, event formatting, ping, and the receive loop.\n- EventController.stream delegates to that module.\n\nAcceptance:\n- Controller contains minimal wiring only.\n- Streaming logic is centralized and testable in one module.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T21:54:19.449454+01:00","updated_at":"2025-12-31T22:16:17.608024+01:00","closed_at":"2025-12-31T22:16:17.608024+01:00"}
{"id":"opencode-squads-hct","title":"Frontend app not loading at localhost:4000 (empty page)","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-31T17:59:22.770677+01:00","updated_at":"2025-12-31T18:00:00.792022+01:00","closed_at":"2025-12-31T18:00:00.792022+01:00"}
{"id":"opencode-squads-hrj","title":"Worktrees + review workflow","description":"Worktree creation, branch naming, PR summary artifact, review states","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-31T11:16:49.507064+01:00","updated_at":"2026-01-01T08:43:37.597061+01:00","closed_at":"2026-01-01T08:43:37.597061+01:00","dependencies":[{"issue_id":"opencode-squads-hrj","depends_on_id":"opencode-squads-w37","type":"blocks","created_at":"2025-12-31T11:30:28.16255+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-hrj.1","title":"Worktree manager with agent-ticket naming","description":"Create/list/remove worktrees named \u003cagent-slug\u003e-\u003cticket-key\u003e","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:21:12.53986+01:00","updated_at":"2025-12-31T17:09:15.399898+01:00","closed_at":"2025-12-31T17:09:15.399898+01:00","dependencies":[{"issue_id":"opencode-squads-hrj.1","depends_on_id":"opencode-squads-hrj","type":"parent-child","created_at":"2025-12-31T11:21:12.540698+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-hrj.1","depends_on_id":"opencode-squads-w37.4","type":"blocks","created_at":"2025-12-31T11:33:50.904065+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-hrj.2","title":"Branch naming + base branch main","description":"Ensure branches use naming scheme and default to main","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:21:17.749958+01:00","updated_at":"2025-12-31T20:25:44.613786+01:00","closed_at":"2025-12-31T20:25:44.613786+01:00","dependencies":[{"issue_id":"opencode-squads-hrj.2","depends_on_id":"opencode-squads-hrj","type":"parent-child","created_at":"2025-12-31T11:21:17.750458+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-hrj.2","depends_on_id":"opencode-squads-hrj.1","type":"blocks","created_at":"2025-12-31T11:33:56.08155+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-hrj.3","title":"PR summary artifact generation","description":"Generate diff summary + tests run for review","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:21:22.932565+01:00","updated_at":"2025-12-31T22:56:53.852254+01:00","closed_at":"2025-12-31T22:56:53.852254+01:00","dependencies":[{"issue_id":"opencode-squads-hrj.3","depends_on_id":"opencode-squads-hrj","type":"parent-child","created_at":"2025-12-31T11:21:22.9334+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-hrj.3","depends_on_id":"opencode-squads-hrj.1","type":"blocks","created_at":"2025-12-31T11:34:01.243753+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-hrj.4","title":"Review workflow states + reviewer assignment","description":"pending/in_review/approved/changes_requested with mentor mapping","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:21:28.131316+01:00","updated_at":"2025-12-31T19:29:53.387774+01:00","closed_at":"2025-12-31T19:29:53.387774+01:00","dependencies":[{"issue_id":"opencode-squads-hrj.4","depends_on_id":"opencode-squads-hrj","type":"parent-child","created_at":"2025-12-31T11:21:28.132151+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-hrj.4","depends_on_id":"opencode-squads-w37.4","type":"blocks","created_at":"2025-12-31T11:34:06.414909+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-hrj.5","title":"Review notifications via mail","description":"Send review requests and outcomes to inbox","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-31T11:21:33.317816+01:00","updated_at":"2025-12-31T22:57:30.76244+01:00","closed_at":"2025-12-31T22:57:30.76244+01:00","dependencies":[{"issue_id":"opencode-squads-hrj.5","depends_on_id":"opencode-squads-hrj","type":"parent-child","created_at":"2025-12-31T11:21:33.318313+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-hrj.5","depends_on_id":"opencode-squads-hrj.4","type":"blocks","created_at":"2025-12-31T11:34:11.591099+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-hrj.5","depends_on_id":"opencode-squads-7ug.2","type":"blocks","created_at":"2025-12-31T11:34:16.762652+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-hrj.6","title":"Merge flow + worktree cleanup","description":"Manual merge support and remove worktrees after approval","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-31T11:21:38.500046+01:00","updated_at":"2025-12-31T23:13:45.21784+01:00","closed_at":"2025-12-31T23:13:45.21784+01:00","dependencies":[{"issue_id":"opencode-squads-hrj.6","depends_on_id":"opencode-squads-hrj","type":"parent-child","created_at":"2025-12-31T11:21:38.500496+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-hrj.6","depends_on_id":"opencode-squads-hrj.1","type":"blocks","created_at":"2025-12-31T11:34:21.93861+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-hrj.6","depends_on_id":"opencode-squads-hrj.4","type":"blocks","created_at":"2025-12-31T11:34:27.103593+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-hue","title":"Gate devtools + remove debug console logs in production","description":"Problem\n- Devtools are mounted unconditionally in production builds:\n  - ReactQueryDevtools in assets/src/main.tsx\n  - TanStackRouterDevtools in assets/src/routes/__root.tsx\n- There are also debug console.log calls left in the chat composer/autocomplete flow.\n\nWhere\n- assets/src/main.tsx:33-36 (ReactQueryDevtools)\n- assets/src/routes/__root.tsx:352 (TanStackRouterDevtools)\n- assets/src/components/SessionChat.tsx:108, 153, 200 (console.log)\n\nImpact\n- Unnecessary bundle weight + potential info leakage in production.\n- Noisy logs during normal usage.\n\nSuggested fix\n- Wrap devtools + debug logs in import.meta.env.DEV (or equivalent).\n- Keep console.error for real failures, but remove or gate noisy logs.\n","acceptance_criteria":"- Devtools only render in development builds.\n- No debug console.log output during normal production usage.\n","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-02T17:40:42.254381+01:00","updated_at":"2026-01-05T09:51:36.036878+01:00","closed_at":"2026-01-05T09:51:36.036878+01:00","labels":["assets","cleanup","dx","frontend"],"dependencies":[{"issue_id":"opencode-squads-hue","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T17:40:42.256078+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-hwk","title":"Expose model context limits for chat header","description":"Extend models API to include context/output limits and display them alongside the active model in the chat header.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-01T12:27:14.447262+01:00","updated_at":"2026-01-01T12:52:08.877822+01:00","closed_at":"2026-01-01T12:52:08.877822+01:00"}
{"id":"opencode-squads-iip","title":"Fleet workflow: message connected squad (Agent Mail MCP)","description":"Work\n- Add a minimal workflow to send a message to a connected squad/team from within Squads.\n- UX: from a squad context, choose \"Message connected squad\", select target squad, compose markdown, send.\n- Backend: resolve target squad's agents/contacts and route via existing mail system / MCP integration.\n- Track the communication as events for audit/history.\n\nNotes\n- Start with human-driven messages; later we can add automation (agents coordinating).\n","acceptance_criteria":"- When two squads are connected, I can send a message from one squad to the other via the UI.\n- The message is visible in the mail UI for the recipient side.\n- An event is recorded for the sent message.\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-02T10:12:46.167327+01:00","updated_at":"2026-01-02T17:54:38.115794+01:00","closed_at":"2026-01-02T17:54:38.115794+01:00","labels":["backend","fleet","frontend","mail"],"dependencies":[{"issue_id":"opencode-squads-iip","depends_on_id":"opencode-squads-5b0","type":"blocks","created_at":"2026-01-02T10:12:46.169082+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-j3o","title":"Fix TypeScript errors and build warnings","description":"Fix pre-existing TSC errors in api/queries.ts, components/SessionChat.tsx, and routes/review.tsx. Also address chunk size warnings if possible.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T08:40:33.815798+01:00","updated_at":"2026-01-02T08:52:27.416691+01:00","closed_at":"2026-01-02T08:52:27.416691+01:00"}
{"id":"opencode-squads-jb3","title":"Implement Start Session UI","description":"Add a 'Start Session' button to the agent details page when the agent is idle. It should trigger the useCreateSession mutation.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-01T11:38:35.560195+01:00","updated_at":"2026-01-01T12:52:03.716045+01:00","closed_at":"2026-01-01T12:52:03.716045+01:00"}
{"id":"opencode-squads-jcd","title":"Agent Session: MCP agent-mail not configured in project opencode.json","description":"The agent sessions are not utilizing the agent-mail MCP, possibly because it's missing from the project's opencode.json configuration. Additionally, the Email UI does not provide confirmation when sending an email; it simply closes the window without feedback.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-01T15:47:21.095028+01:00","updated_at":"2026-01-01T19:02:06.348267+01:00","closed_at":"2026-01-01T19:02:06.348267+01:00"}
{"id":"opencode-squads-jrc","title":"Move ticket board and sync orchestration into Tickets context","description":"Problem:\n- TicketController.board and TicketController.sync orchestrate multiple context calls and assemble response summaries.\n- This is domain logic living in the web layer and is harder to test.\n\nProposal:\n- Add Tickets.board_summary(project_id) to return grouped ticket lists (ready/in_progress/blocked/closed).\n- Add Tickets.sync_all(project_id) to run sync_from_beads plus sync_dependencies and return a summary map.\n\nAcceptance:\n- TicketController delegates to context functions and only renders results.\n- Board and sync logic is consolidated and unit-testable in Squads.Tickets.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T21:54:14.250577+01:00","updated_at":"2025-12-31T22:15:47.243097+01:00","closed_at":"2025-12-31T22:15:47.243097+01:00"}
{"id":"opencode-squads-k2v","title":"Refactor SessionController OpenCode error responses","description":"Problem:\n- SessionController repeats mapping of OpenCode failures to HTTP 502 responses and JSON payloads across start/stop/messages/diff/todos/prompt/command/shell endpoints.\n- Duplication makes it easy for response shapes or status codes to drift.\n\nProposal:\n- Introduce a shared helper (FallbackController clause or SquadsWeb.API.ErrorResponses) that renders opencode_error responses.\n- Replace repeated {:error, {:opencode_error, reason}} branches with the helper call.\n\nAcceptance:\n- All session endpoints return a consistent opencode_error payload and status.\n- SessionController no longer contains duplicated opencode_error branches.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T21:54:03.902096+01:00","updated_at":"2025-12-31T22:18:13.107908+01:00","closed_at":"2025-12-31T22:18:13.107908+01:00"}
{"id":"opencode-squads-kro","title":"Chat UI: Initial message resends multiple times during subagent task and loading stops prematurely","description":"In the Chat UI, sending a request that triggers a subagent task causes the loading indicator to stop prematurely after the first response. Subsequently, the initial message appears to be resent multiple times until the subagent response is received. This likely involves how long-running subagent tasks are handled in the session prompt workflow.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-01T15:41:02.297347+01:00","updated_at":"2026-01-01T19:04:11.272742+01:00","closed_at":"2026-01-01T19:04:11.272742+01:00"}
{"id":"opencode-squads-l6i","title":"Board: ticket status/assignee updates broken (useUpdateTicket logic)","description":"Problem\n- useUpdateTicket in assets/src/api/queries.ts attempts to handle both status updates and assignee (claim) updates.\n- The current branching logic always takes the status-update path because data.status is always present.\n- Ticket Inspector calls updateTicket.mutate with both status + assignee, so the assignee branch is never reached.\n- There is also placeholder/incorrect payload for claim (agent_id: \"current-user-or-agent\").\n\nWhere\n- assets/src/api/queries.ts:646-675 (useUpdateTicket)\n- assets/src/components/board/TicketFlow.tsx:157-161 (handleUpdateAssignee)\n\nImpact\n- Board UI appears to let you assign tickets, but assignment does not persist.\n- Status updates may work but API semantics are unclear/fragile.\n\nSuggested fix\n- Split into explicit hooks/mutations that mirror backend endpoints:\n  - useUpdateTicketStatus (PATCH /tickets/:id/status)\n  - useClaimTicket (POST /tickets/:id/claim)\n  - useUnclaimTicket (POST /tickets/:id/unclaim) or equivalent\n- Update TicketFlow to call the correct mutation depending on the user action.\n- Remove placeholder agent_id and use real agent identifier(s) from the active project context.\n- Ensure frontend uses the correct assignee field (assignee_name vs assignee_id) consistently.\n\nNotes\n- After fixing, also align React Query invalidation keys so board refresh is reliable.\n","acceptance_criteria":"- Changing status updates correctly and refreshes the board.\n- Changing assignee correctly claims/unclaims the ticket with correct agent identity.\n- No placeholder agent IDs remain.\n","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-02T17:39:14.360849+01:00","updated_at":"2026-01-02T19:17:14.058004+01:00","closed_at":"2026-01-02T19:17:14.058004+01:00","labels":["api","assets","board","frontend","react-query","tickets"],"dependencies":[{"issue_id":"opencode-squads-l6i","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T17:39:14.362941+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-lue","title":"Fix /agent nested routing to render agent detail","description":"Context\n- We use TanStack Router file-based routing. Today /agent renders the registry list but does not render an \u003cOutlet/\u003e, so /agent/$agentId never mounts.\n\nWork\n- Update /agent route to act as a layout route (render \u003cOutlet/\u003e).\n- Keep agent registry accessible as the index route (or equivalent).\n- Ensure deep links and in-app links both work.\n","acceptance_criteria":"- Navigating to /agent/\u003cagentId\u003e renders the agent detail view.\n- Navigating to /agent renders the agent registry list.\n- Agent links from registry and sessions page navigate correctly.\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T10:07:07.180992+01:00","updated_at":"2026-01-02T12:18:59.739822+01:00","closed_at":"2026-01-02T12:18:59.739822+01:00","labels":["frontend","routing"],"dependencies":[{"issue_id":"opencode-squads-lue","depends_on_id":"opencode-squads-v3q","type":"blocks","created_at":"2026-01-02T10:07:07.182344+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-lum","title":"Connect epics with tickets through edges in graph view","description":"Add visual edges/connections in the beads ticket graph view to show relationships between epics and their child tickets. This will make the hierarchical structure and dependencies more visible in the board visualization.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T12:15:20.486311+01:00","updated_at":"2026-01-01T13:28:53.3921+01:00","closed_at":"2026-01-01T13:28:53.3921+01:00"}
{"id":"opencode-squads-m42","title":"Backend: ExternalNodeController naming inconsistency in router","description":"The router (lib/squads_web/router.ex) references SquadsWeb.API.ExternalNodeController but it should likely be SquadsWeb.Api.ExternalNodeController (case sensitivity issue). This causes a compilation warning/failure.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T16:51:23.126352+01:00","updated_at":"2026-01-02T16:55:23.649406+01:00","closed_at":"2026-01-02T16:55:23.649406+01:00"}
{"id":"opencode-squads-mdu","title":"Agent created ticket in wrong repository (cross-repo pollution)","description":"An agent in project 'protobuf_generate' created a bd ticket in the 'on_boarding' repository when asked via chat. Investigate how the working directory or project context is being leaked or incorrectly set when running bd commands via agents.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-01T12:29:26.39+01:00","updated_at":"2026-01-01T13:15:46.803201+01:00","closed_at":"2026-01-01T13:15:46.803201+01:00"}
{"id":"opencode-squads-mje","title":"Web UI: Error when switching to Todos or Diff tabs in Session view","description":"Switching to the 'Todos' or 'Diff' tabs in the session UI returns an error. This prevents users from viewing task progress and code changes within a session.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T16:17:17.687741+01:00","updated_at":"2026-01-02T16:56:22.005279+01:00","closed_at":"2026-01-02T16:56:22.005279+01:00"}
{"id":"opencode-squads-n9d","title":"Show tokens, cost, and reasoning in chat messages","description":"Surface AssistantMessage/StepFinish tokens + cost metadata and provide a collapsible reasoning section when ReasoningPart appears.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T12:27:00.604966+01:00","updated_at":"2026-01-01T13:09:55.308091+01:00","closed_at":"2026-01-01T13:09:55.308093+01:00"}
{"id":"opencode-squads-nkc","title":"Event kind naming mismatch (session. vs session:) breaks filtering/invalidation","description":"Problem\n- Different parts of the frontend assume different event.kind formats:\n  - Root SSE invalidation checks for kind.startsWith(\"session.\") / \"agent.\" / \"ticket.\" (dot).\n  - EventTimeline + Events page filtering assume kind starts with \"session:\" / \"agent:\" / \"ticket:\" (colon).\n  - SessionChat websocket invalidation checks exact kinds like \"session:status_changed\" and \"message:created\".\n\nWhere\n- assets/src/routes/__root.tsx:103-116 (dot-prefix checks)\n- assets/src/components/events/EventTimeline.tsx:91-108 (colon-prefix mapping)\n- assets/src/routes/events.tsx:35-42 (kindFilter values use colon)\n- assets/src/components/SessionChat.tsx:104-112 (colon kinds)\n\nImpact\n- Some events will not be categorized/filtered correctly.\n- Realtime invalidations can silently fail depending on backend kind format.\n\nSuggested fix\n- Choose one canonical event naming convention (recommend namespace:event with colon, e.g. session:status_changed).\n- Update SSE invalidation + filtering + icon mapping to match.\n- If backend emits dot-form, update backend emitter (or normalize on the client in one place).\n","acceptance_criteria":"- All event-driven invalidations fire reliably for sessions/agents/tickets/mail.\n- Events page filters by kind correctly.\n- EventTimeline icons/labels match the emitted event kinds.\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T17:40:00.821472+01:00","updated_at":"2026-01-02T19:21:58.511445+01:00","closed_at":"2026-01-02T19:21:58.511445+01:00","labels":["assets","events","frontend","realtime"],"dependencies":[{"issue_id":"opencode-squads-nkc","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T17:40:00.826387+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-no3","title":"Design: external node discovery providers + security model","description":"Goal\n- Define a production-capable discovery approach for external OpenCode servers, with an explicit security boundary.\n\nDeliverables\n- A short written spec (in issue description/design) covering:\n  - Discovery providers to support in Phase 1 (LocalHostPorts, ConfiguredEndpoints).\n  - Optional provider for Phase 2 (SelfRegistration/heartbeat) and when we'd use it.\n  - Scoping rules: localhost-only by default; allowlist for other hosts; rate limiting; timeouts.\n  - How we identify \"this is OpenCode\" (probe GET /global/health) and how we detect the node's working directory/project.\n  - UX behavior for nodes that disappear (stale).\n  - What \"attach\" means in external-live phase (no DB import; optional \"pin\" of endpoint).\n","acceptance_criteria":"- Spec clearly states how discovery works in dev and in production.\n- Spec includes concrete limits (hosts, ports, retry policy) and security controls (allowlist/denylist).\n- Spec defines API surface for listing nodes and proxying operations.\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T10:10:00.429315+01:00","updated_at":"2026-01-02T17:14:50.530092+01:00","closed_at":"2026-01-02T17:14:50.530092+01:00","labels":["backend","design","discovery","security"],"dependencies":[{"issue_id":"opencode-squads-no3","depends_on_id":"opencode-squads-oz5","type":"blocks","created_at":"2026-01-02T10:10:00.430989+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-nrt","title":"Render markdown with syntax highlighting in chat output","description":"Render markdown with syntax highlighting in OpenCode chat output","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T12:35:36.103891+01:00","updated_at":"2026-01-01T13:09:50.168933+01:00","closed_at":"2026-01-01T13:09:50.168934+01:00"}
{"id":"opencode-squads-o49","title":"Web UI: Remove 'Start New Session' button from Chat window","description":"When there is no active session, an enormous 'Start New Session' button appears in the chat window. This should be removed or replaced with a more subtle UI element, as creating sessions should be handled via the agent views or command patterns.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-02T17:03:29.625989+01:00","updated_at":"2026-01-02T17:11:36.760035+01:00","closed_at":"2026-01-02T17:11:36.760035+01:00"}
{"id":"opencode-squads-obn","title":"Centralize session params normalization","description":"Problem:\n- SessionController.create and SessionController.start build nearly identical attrs maps (agent_id, ticket_key, worktree_path, branch, metadata, title).\n- Duplicated mapping invites missing fields or inconsistent defaults as the schema evolves.\n\nProposal:\n- Add a single params normalizer (Sessions.build_attrs/1 or SquadsWeb.API.SessionParams.normalize/1).\n- Use the helper in create/start and any related endpoints that construct session attrs.\n\nAcceptance:\n- Attr mapping lives in one place with shared defaults (metadata fallback, optional title).\n- Controller actions call the helper and contain minimal param logic.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T21:54:09.073981+01:00","updated_at":"2025-12-31T22:15:15.974562+01:00","closed_at":"2025-12-31T22:15:15.974562+01:00"}
{"id":"opencode-squads-ois","title":"Frontend: Enhance Review Queue diff navigation","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T18:51:27.860139+01:00","updated_at":"2025-12-31T18:53:07.721395+01:00","closed_at":"2025-12-31T18:53:07.721395+01:00","dependencies":[{"issue_id":"opencode-squads-ois","depends_on_id":"opencode-squads-803.23","type":"discovered-from","created_at":"2025-12-31T18:51:27.861775+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-ojc","title":"Global sessions route grouped by squad","description":"Add /sessions route listing running, pending, and paused sessions across all projects. Group sessions by squad using agent_id; include an Unassigned group when needed and show agent, status, ticket key, branch/worktree, and timestamps.","acceptance_criteria":"Route is accessible from nav; sessions filtered to running/pending/paused; grouped by squad and unassigned; empty state when none; agent links navigate to agent detail.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-01T13:56:22.048958+01:00","updated_at":"2026-01-01T15:04:55.761571+01:00","closed_at":"2026-01-01T15:04:55.761571+01:00"}
{"id":"opencode-squads-ox7","title":"UX: command palette reliability + dedupe","description":"Context\n- During Playwright ad-hoc testing, the Global Command Menu showed duplicate entries (e.g., New Session twice) and Meta+K did not reliably open until clicking the button.\n\nGoal\n- Make Cmd/Meta+K keyboard-first flows dependable and reduce noise in suggestions.\n","acceptance_criteria":"- Cmd/Meta+K opens the command palette reliably across routes.\n- Command list has no duplicates and categories are clear.\n- Top suggestions are stable and relevant (navigation + recent + context-aware actions).\n","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-02T17:55:13.335313+01:00","updated_at":"2026-01-05T10:06:46.376359+01:00","closed_at":"2026-01-05T10:06:46.376359+01:00","labels":["assets","commands","frontend","ux"]}
{"id":"opencode-squads-ox7.1","title":"Command palette: remove duplicate 'New Session' entries","description":"Problem\n- Suggestions list can show duplicated actions (observed New Session twice).\n\nWork\n- Identify why duplicates occur (data source merge, keying, recent items, context items).\n- De-dupe by stable command ID before rendering.\n","acceptance_criteria":"- No duplicate commands appear in the suggestions list.\n- Dedupe preserves ordering and keyboard navigation.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T17:55:37.781735+01:00","updated_at":"2026-01-02T19:37:52.339536+01:00","closed_at":"2026-01-02T19:37:52.339536+01:00","labels":["assets","commands","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-ox7.1","depends_on_id":"opencode-squads-ox7","type":"parent-child","created_at":"2026-01-02T17:55:37.782501+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-ox7.2","title":"Command palette: make Cmd/Meta+K open reliably","description":"Problem\n- Meta+K did not reliably open the command palette during automated interaction; opening via button worked.\n\nWork\n- Verify keybinding registration and focus behavior across routes.\n- Ensure the shortcut works even when focus is inside inputs (unless explicitly excluded).\n- Add a lightweight e2e check if possible.\n","acceptance_criteria":"- Cmd/Meta+K toggles the command palette from any route.\n- Works regardless of focus state (unless an explicit, documented exception applies).\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T17:55:56.172738+01:00","updated_at":"2026-01-02T19:27:56.361133+01:00","closed_at":"2026-01-02T19:27:56.361133+01:00","labels":["assets","commands","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-ox7.2","depends_on_id":"opencode-squads-ox7","type":"parent-child","created_at":"2026-01-02T17:55:56.173501+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-ox7.3","title":"Command palette: improve grouping labels + relevance ordering","description":"Problem\n- Categories and ordering can feel noisy when mixing Navigation, Agents, Squads, Recent Sessions, Projects, etc.\n\nWork\n- Define clear group headings and a stable ordering (e.g., Actions, Navigation, Recent, Entities).\n- Tune ranking so context-aware actions appear first without duplicating global actions.\n","acceptance_criteria":"- Groups and ordering are consistent across routes.\n- Top suggestions feel relevant and are stable across refreshes.\n","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-02T17:56:12.554315+01:00","updated_at":"2026-01-02T17:56:12.554315+01:00","labels":["assets","commands","frontend","ux"],"dependencies":[{"issue_id":"opencode-squads-ox7.3","depends_on_id":"opencode-squads-ox7","type":"parent-child","created_at":"2026-01-02T17:56:12.554869+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-oz5","title":"External OpenCode nodes (ronin): discover + attach (live mode)","description":"Problem\n- Today Squads only manages OpenCode servers it starts per project.\n- We want to discover \"non-squad\" OpenCode instances (eg someone ran `opencode serve` manually) and treat them as transient/ronin agents not attached to a squad.\n- Users should be able to \"attach\" to these live instances, browse their sessions, and interact, without importing them into Squads DB initially.\n\nGoals (Phase 1: external live)\n- Auto-discover reachable OpenCode servers and show them as \"External Nodes\".\n- Allow browsing remote sessions + messages and sending prompts/commands via Squads as a proxy.\n- Provide a manual \"Add node by URL\" fallback.\n\nProduction requirement\n- lsof-based discovery is useful on dev hosts but not reliable everywhere (permissions, containers, minimal images).\n- We need a production-capable discovery mechanism in addition to local scanning (eg configured endpoints and/or node self-registration heartbeat).\n\nNon-goals (Phase 1)\n- Import remote sessions into Squads sessions table.\n- Automatically creating squads/agents for ronin nodes.\n\nProposed architecture\n- Introduce a discovery subsystem with pluggable providers:\n  1) LocalHostPorts: uses lsof/netstat to get listening ports and probes candidates via /global/health.\n  2) ConfiguredEndpoints: reads a configured list of base URLs (env/config/db) and probes them.\n  3) (Optional later) SelfRegistration: external node heartbeats to Squads for discovery.\n- Represent discovered nodes with: base_url, last_seen_at, health, version, current project directory (if exposed), discovery_source.\n- Expose API to list nodes and to proxy key OpenCode calls (sessions, messages, prompt, command, shell).\n\nSecurity\n- Default discovery scope should be safe (localhost only unless explicitly configured).\n- Add allowlist/denylist controls and rate limits to avoid scanning arbitrary networks.\n","design":"Notes\n- Prefer server-side discovery + proxy to avoid browser CORS issues.\n- Reuse Squads.OpenCode.Client with base_url override per node.\n- Keep Phase 1 \"external live\" stateless where possible; store only minimal state (last_seen) if needed.\n","acceptance_criteria":"- There is an API to list discovered external OpenCode nodes (including health/version/base_url and discovery source).\n- There is a UI that shows external nodes and lets me open a node to view its sessions and session transcripts.\n- I can interact with an external session (send prompt/command/shell) through Squads without importing it into the Squads DB.\n- There is a production-capable discovery path (configured endpoints and/or heartbeat), not only lsof.\n","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-02T10:09:42.866135+01:00","updated_at":"2026-01-02T17:14:32.591165+01:00","closed_at":"2026-01-02T17:14:32.591165+01:00","labels":["backend","discovery","frontend","opencode"]}
{"id":"opencode-squads-oz5.2","title":"Implement Discovery Context and Strategies","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T17:12:11.848597+01:00","updated_at":"2026-01-02T17:13:34.447908+01:00","closed_at":"2026-01-02T17:13:34.447908+01:00","dependencies":[{"issue_id":"opencode-squads-oz5.2","depends_on_id":"opencode-squads-oz5","type":"parent-child","created_at":"2026-01-02T17:12:11.849629+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-oz5.3","title":"Implement Discovery API Endpoints","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T17:12:20.419003+01:00","updated_at":"2026-01-02T17:13:55.401067+01:00","closed_at":"2026-01-02T17:13:55.401067+01:00","dependencies":[{"issue_id":"opencode-squads-oz5.3","depends_on_id":"opencode-squads-oz5","type":"parent-child","created_at":"2026-01-02T17:12:20.420141+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-oz5.4","title":"Implement Frontend for External Nodes","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T17:12:29.354104+01:00","updated_at":"2026-01-02T17:14:23.780883+01:00","closed_at":"2026-01-02T17:14:23.780883+01:00","dependencies":[{"issue_id":"opencode-squads-oz5.4","depends_on_id":"opencode-squads-oz5","type":"parent-child","created_at":"2026-01-02T17:12:29.354956+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-p5r","title":"Fix board API route mismatch and handle missing .beads init","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-01T09:11:10.354336+01:00","updated_at":"2026-01-01T10:21:31.44094+01:00","closed_at":"2026-01-01T10:21:31.44094+01:00"}
{"id":"opencode-squads-php","title":"Running session not visible in active filter on agent page","description":"A user reported that even though a session is running, it does not appear when the 'active' filter is selected on the agent detail page, but it is visible in the 'all' view. This suggests a filtering logic mismatch in assets/src/routes/agent.$agentId.tsx.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T20:24:23.525243+01:00","updated_at":"2026-01-02T20:24:56.840327+01:00","closed_at":"2026-01-02T20:24:56.840327+01:00","dependencies":[{"issue_id":"opencode-squads-php","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T20:24:23.526291+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-qbz","title":"API: external nodes + proxy for sessions/messages/prompt","description":"Work\n- Add API endpoints to:\n  - List discovered external nodes (merged from discovery providers).\n  - Fetch node details (health/version/project directory if available).\n  - Proxy core OpenCode calls through Squads (to avoid browser CORS):\n    - list sessions\n    - get session messages\n    - send prompt\n    - execute command\n    - run shell\n- Use base_url override when calling Squads.OpenCode.Client.\n- Validate inputs and prevent SSRF-style abuse (only allow localhost or configured allowlist).\n\nAPI sketch\n- GET /api/opencode/nodes\n- GET /api/opencode/nodes/:nodeKey\n- GET /api/opencode/nodes/:nodeKey/sessions\n- GET /api/opencode/nodes/:nodeKey/sessions/:sessionID/messages\n- POST /api/opencode/nodes/:nodeKey/sessions/:sessionID/prompt\n- POST /api/opencode/nodes/:nodeKey/sessions/:sessionID/command\n- POST /api/opencode/nodes/:nodeKey/sessions/:sessionID/shell\n\nNotes\n- nodeKey could be a stable hash of base_url or a persisted id if we add \"pinned nodes\" later.\n","acceptance_criteria":"- External nodes can be listed via API with basic metadata.\n- From the UI, we can proxy list sessions and open transcripts reliably (no CORS issues).\n- Proxy endpoints reject disallowed hosts and enforce timeouts.\n","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-02T10:10:52.725173+01:00","updated_at":"2026-01-02T17:15:16.500051+01:00","closed_at":"2026-01-02T17:15:16.500051+01:00","labels":["api","backend","opencode"],"dependencies":[{"issue_id":"opencode-squads-qbz","depends_on_id":"opencode-squads-oz5","type":"blocks","created_at":"2026-01-02T10:10:52.726538+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-qyb","title":"Fix Board UI crash","description":"The /board route crashes in the client and fails to render tickets. Investigate potential issues with ReactFlow, ELK, or data fetching.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-01T08:49:19.106331+01:00","updated_at":"2026-01-01T08:51:55.26976+01:00","closed_at":"2026-01-01T08:51:55.26976+01:00"}
{"id":"opencode-squads-r4l","title":"Investigate persistent backend connection error in frontend","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-01T08:58:36.235614+01:00","updated_at":"2026-01-01T09:03:23.624589+01:00","closed_at":"2026-01-01T09:03:23.624589+01:00"}
{"id":"opencode-squads-rni","title":"OpenCode client 204 handling unreachable","description":"handle_response in lib/squads/opencode/client.ex:335 matches status 200..299 before the 204 clause, so 204 never returns true as documented. Move 204 clause above or narrow the range to exclude 204.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T17:55:53.503628+01:00","updated_at":"2025-12-31T18:03:18.588465+01:00","closed_at":"2025-12-31T18:03:18.588465+01:00"}
{"id":"opencode-squads-s4s","title":"Integrate Frontend with Backend APIs","description":"Replace mock data in React components with real data from Phoenix APIs using TanStack Query. Targets: Dashboard, Squad Roster, and Agent Details.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T14:05:17.01204+01:00","updated_at":"2025-12-31T14:08:52.134518+01:00","closed_at":"2025-12-31T14:08:52.134518+01:00","dependencies":[{"issue_id":"opencode-squads-s4s","depends_on_id":"opencode-squads-803","type":"blocks","created_at":"2025-12-31T14:05:17.013531+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-scm","title":"Implement Squads.MCP.Server schema and CRUD","description":"Reference: docs/prd-mcp-agents.md (Implementation Plan: Phase 1, Core Context).\n\nCreate Squads.MCP.Server schema with changeset validations for required fields (squad_id, name, source, type). Validate source in [builtin, registry, custom] and type in [remote, container]. Add context functions in Squads.MCP for list/get/create/update/delete scoped to squad_id. Ensure JSON fields use map defaults and avoid nil crashes.","acceptance_criteria":"- Schema file added under lib/squads/mcp/server.ex.\n- Context functions added to Squads.MCP.\n- Invalid source/type rejected with clear errors.\n- CRUD functions are covered by unit tests.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T21:48:26.393654+01:00","updated_at":"2026-01-02T21:48:26.393654+01:00"}
{"id":"opencode-squads-svc","title":"Discovery provider: ConfiguredEndpoints (production-safe)","description":"Problem\n- In production/containerized environments, lsof/netstat may be unavailable or too privileged. We still need discovery.\n\nWork\n- Implement a discovery provider that reads a configured list of OpenCode base URLs and probes them.\n- Configuration options (pick at least one for Phase 1):\n  - ENV: OPENCODE_EXTERNAL_BASE_URLS=\"http://host1:4096,http://host2:4096\"\n  - App config: config/runtime.exs list\n  - (Optional) Persisted list in DB for UI-managed \"pinned nodes\"\n- Probe each base_url via /global/health and surface status/last_seen.\n\nSecurity\n- Allowlist-based; no scanning.\n- Optional TLS and auth story documented (even if not implemented yet).\n","acceptance_criteria":"- Given a configured list of base URLs, Squads lists them as external nodes with health/version/last_seen.\n- Misconfigured/unreachable nodes appear as unhealthy with useful error info.\n- No OS-specific tooling is required for this provider.\n","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-02T10:10:34.139527+01:00","updated_at":"2026-01-02T17:15:08.00641+01:00","closed_at":"2026-01-02T17:15:08.00641+01:00","labels":["backend","config","discovery"],"dependencies":[{"issue_id":"opencode-squads-svc","depends_on_id":"opencode-squads-oz5","type":"blocks","created_at":"2026-01-02T10:10:34.141202+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-sxz","title":"SessionChat: support /commands and !shell (OpenCode-style)","description":"Context\n- OpenCode TUI supports /commands (eg /new, /sessions, /compact) and !shell commands.\n- Squads backend already exposes /api/sessions/:id/command and /api/sessions/:id/shell, but the web chat currently always POSTs /prompt.\n\nWork\n- In the web chat composer, interpret leading '/' as a session command and call POST /api/sessions/:id/command.\n- Interpret leading '!' as a shell command and call POST /api/sessions/:id/shell.\n- Show the resulting output in the transcript in a readable, consistent way (treated like an assistant/tool message).\n- Keep /new as a special-case UX shortcut (it may call the dedicated new-session endpoint).\n\nSafety\n- Add confirm prompts and/or allowlists for potentially dangerous shell commands if needed.\n","acceptance_criteria":"- Typing /help (or any configured command) invokes the session command endpoint and shows output in chat.\n- Typing !git status invokes the shell endpoint and shows output in chat.\n- Regular messages (no leading / or !) continue to send prompts normally.\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-02T10:08:57.024572+01:00","updated_at":"2026-01-02T11:35:58.969709+01:00","closed_at":"2026-01-02T11:35:58.969709+01:00","labels":["commands","frontend","sessions"],"dependencies":[{"issue_id":"opencode-squads-sxz","depends_on_id":"opencode-squads-v3q","type":"discovered-from","created_at":"2026-01-02T10:08:57.026371+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-tb0","title":"409 Conflict when sending messages to historical sessions","description":"Sending a message to a completed/historical session returns a 409 Conflict. The system should allow continuing historical sessions, possibly by reactivating them or allowing the backend to transition them back to 'running'.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T14:55:27.601398+01:00","updated_at":"2026-01-02T15:20:42.885729+01:00","closed_at":"2026-01-02T15:20:42.885729+01:00"}
{"id":"opencode-squads-uc9","title":"Historical sessions showing 'Start Session' button and blocking chat","description":"When selecting a historical session, the UI shows a 'Start Session' button overlay that blocks the messages, and doesn't allow sending messages. Historical sessions should be viewable without the overlay, and should be reactivatable or at least the UI shouldn't be blocked.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T14:46:41.949682+01:00","updated_at":"2026-01-02T14:47:17.91532+01:00","closed_at":"2026-01-02T14:47:17.91532+01:00"}
{"id":"opencode-squads-ucf","title":"Sessions page: add History/All views (not just active)","description":"Problem\n- /sessions currently labels itself ACTIVE_SESSIONS and only shows running/pending/paused. This hides historical sessions and makes it hard to audit or resume context.\n\nWork\n- Add UI filtering on the Sessions page: Active / History / All.\n- History should include completed/failed/cancelled (per requirement).\n- Adjust empty states, counts, and headings accordingly.\n- Ensure chat flyout works for historical sessions (read-only).\n","acceptance_criteria":"- Sessions page can display historical sessions (completed/failed/cancelled) and all sessions.\n- Active sessions view remains available and is the default (or clearly selected).\n- Selecting a historical session opens transcript in read-only mode (no prompt composer).\n","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-02T10:08:34.94846+01:00","updated_at":"2026-01-02T15:23:11.491837+01:00","closed_at":"2026-01-02T15:23:11.491837+01:00","labels":["frontend","sessions","ux"],"dependencies":[{"issue_id":"opencode-squads-ucf","depends_on_id":"opencode-squads-v3q","type":"blocks","created_at":"2026-01-02T10:08:34.950675+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-uf8","title":"Realtime uplink: SSE is closed on error (no auto-reconnect)","description":"Problem\n- Root app shell creates an EventSource stream per active project.\n- On error, it calls eventSource.close() (assets/src/routes/__root.tsx:120-124).\n- This prevents the browser's built-in EventSource retry behavior, while the UI implies it will retry/recover.\n\nWhere\n- assets/src/routes/__root.tsx:79-129 (EventSource setup + onerror handler)\n- assets/src/routes/__root.tsx:323-336 (UI message: Uplink_Signal_Lost_Retrying...)\n\nImpact\n- Any transient backend restart/network glitch permanently disables realtime updates until full page reload.\n- Query invalidation + notifications stop, so the UI can become stale.\n\nSuggested fix\nOption A (simplest): do NOT call close() in onerror; rely on native EventSource retry.\nOption B: implement an explicit reconnect loop with backoff/jitter, and ensure cleanup cancels pending retries.\n- Ensure sseStatus reflects actual behavior (connecting/connected/error).\n","acceptance_criteria":"- When backend restarts or network blips, SSE reconnects automatically without manual reload.\n- Status indicator returns to CONNECTED after recovery.\n- Realtime-driven query invalidations resume after reconnect.\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-02T17:39:46.233844+01:00","updated_at":"2026-01-02T19:19:08.110687+01:00","closed_at":"2026-01-02T19:19:08.110687+01:00","labels":["assets","frontend","realtime","sse"],"dependencies":[{"issue_id":"opencode-squads-uf8","depends_on_id":"opencode-squads-z6z","type":"discovered-from","created_at":"2026-01-02T17:39:46.235773+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-ujn","title":"Add squad MCP tables and indexes","description":"Reference: docs/prd-mcp-agents.md (Implementation Plan: Phase 1, Data Model).\n\nAdd a migration that introduces squad-level MCP storage in a new squad_mcp_servers table. Fields should include squad_id, name, source, type, image, url, command, args (json), headers (json), enabled, status, last_error, catalog_meta (json), tools (json), and timestamps. Add a unique index on (squad_id, name) and index on squad_id, enabled, status. Default enabled false, status \"unknown\".","acceptance_criteria":"- Migration exists under priv/repo/migrations.\n- Table schema includes required columns and JSON fields.\n- Unique index on squad_id + name.\n- Migration runs cleanly with ecto.migrate.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T21:48:21.211714+01:00","updated_at":"2026-01-02T21:48:21.211714+01:00"}
{"id":"opencode-squads-ulc","title":"API: /new session for agent (stop active + start new)","description":"Problem\n- The web UI needs a reliable way to implement /new: stop the current active session for an agent and immediately start a fresh one.\n- Doing this purely client-side (stop then start) risks races (multiple clicks, concurrent clients) and inconsistent metadata.\n\nWork\n- Add a backend endpoint that performs: (1) find active session for agent, (2) stop it (abort OpenCode session), (3) mark Session.metadata.terminated_by=\"user\" (+ terminated_at timestamp), (4) create_and_start a new session for the same agent.\n- Ensure the OpenCode server instance remains running (do not dispose the project server).\n- Define behavior if there is no active session: just create_and_start.\n- Define behavior if stop fails (OpenCode session missing, etc): still mark local session finished and proceed.\n\nAPI shape (proposal)\n- POST /api/agents/:agent_id/sessions/new  { title?, ticket_key?, model?, ... }\n- Response: the newly started Session record.\n","design":"Implementation notes\n- Reuse existing Sessions.stop_session/2 and Sessions.create_and_start_session/2.\n- Add a helper to find active session for agent_id (status==running or pending?).\n- Consider a DB-level constraint or transaction/locking strategy to prevent double-running.\n- Emit an event (session.status_changed) so SSE invalidation updates clients.\n","acceptance_criteria":"- Calling the endpoint when an agent has an active session results in: old session becomes completed with metadata.terminated_by=\"user\", and a new session is created+started and returned.\n- Calling it when no session is active simply returns a newly started session.\n- The OpenCode server for the project remains running (no restart).\n- Operation is safe under repeated calls (no multiple \"running\" sessions for same agent).\n","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-02T10:08:04.303955+01:00","updated_at":"2026-01-02T15:23:11.489028+01:00","closed_at":"2026-01-02T15:23:11.489028+01:00","labels":["api","backend","sessions"],"dependencies":[{"issue_id":"opencode-squads-ulc","depends_on_id":"opencode-squads-v3q","type":"blocks","created_at":"2026-01-02T10:08:04.305551+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-uwt","title":"Add 'Neural Link' Reasoning HUD","description":"A dedicated view or floating panel to visualize agent 'thoughts' (chains of thought) and token streaming in real-time.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T20:54:46.999761+01:00","updated_at":"2026-01-01T21:41:41.51624+01:00","closed_at":"2026-01-01T21:41:41.51624+01:00"}
{"id":"opencode-squads-v3q","title":"Agent sessions: history, switcher, and /new UX","description":"Problem\n- We currently behave like: 1 active session per agent; historical sessions exist but have no first-class UI.\n- Global Sessions page only shows running/pending/paused.\n- Creating a new session is not discoverable (no /new equivalent).\n- /agent/:id view is currently unreachable due to routing (no \u003cOutlet/\u003e under /agent).\n\nGoals\n- Make historical sessions (completed/failed/cancelled) visible and selectable per agent.\n- Let users switch between an agent's sessions (active + history) without a separate \"details view\".\n- Add an easy \"New Session\" path (command palette + in-chat /new).\n- /new behavior: stop current active session, mark metadata.terminated_by=\"user\", and start a new session; keep the OpenCode server instance running.\n- Keep UX consistent across Agent page and Sessions page.\n\nNon-goals\n- Importing external OpenCode sessions into Squads DB (separate epic).\n- Supporting multiple concurrent running sessions per agent (explicitly not desired).\n\nUX direction (proposal)\n- Agent page becomes a split view: left rail = sessions list (Active + History); main panel = selected session (chat transcript, todos/diff, events).\n- Selecting a historical session shows transcript in read-only mode (composer disabled).\n- Add filters: Active / History / All.\n\nAPI/Model notes\n- Use Session.metadata to record termination provenance (terminated_by: user, terminated_at, optional reason).\n- Consider adding an atomic backend endpoint for /new so stop+start is consistent.\n","design":"Implementation sketch\n- Fix routing so /agent/$agentId renders (Outlet under /agent).\n- Introduce a shared SessionSwitcher component used by Agent view + Sessions view.\n- Add frontend command parsing: \"/...\" routes to /api/sessions/:id/command; \"!/cmd\" routes to /api/sessions/:id/shell; /new is handled locally (stop+start) or via a dedicated endpoint.\n- Prefer a backend endpoint for \"new session for agent\" to avoid race conditions (active session detection + stop + create/start).\n","acceptance_criteria":"- From an agent context, I can see Active and Historical sessions for that agent, sorted newest first.\n- I can click any session and see its transcript (and other panels) without leaving the agent context.\n- Historical sessions render read-only (no prompt composer).\n- I can create a new session via command palette action and via typing /new in a chat composer.\n- /new stops the current active session (no OpenCode server restart), writes metadata.terminated_by=\"user\", then starts a new session and makes it the active one.\n- Sessions page can show History/All (not just active statuses).\n","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-02T10:05:27.828322+01:00","updated_at":"2026-01-02T11:36:09.205174+01:00","closed_at":"2026-01-02T11:36:09.205174+01:00","labels":["backend","frontend","sessions","ux"]}
{"id":"opencode-squads-via","title":"Discovery provider: LocalHostPorts (lsof/netstat)","description":"Work\n- Implement a discovery provider that enumerates listening TCP ports on the host (prefer lsof; fallback netstat/ss) and probes candidates to find OpenCode servers.\n- Candidate validation: GET {base_url}/global/health must respond with healthy/version.\n- Extract optional metadata (project directory) via OpenCode endpoints when possible.\n- Make the provider resilient: if tools are missing or permissions denied, return empty + diagnostics instead of crashing.\n\nConstraints\n- Avoid scanning arbitrary networks. Limit to localhost and to ports discovered by OS tooling.\n- Add timeouts and concurrency limits for probing.\n","acceptance_criteria":"- When running on a host with lsof, the provider discovers local OpenCode servers that are listening and returns their base URLs + version/health.\n- When lsof is unavailable, it falls back to another supported mechanism or returns a clear diagnostic.\n- Discovery does not probe beyond localhost by default.\n","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-02T10:10:20.416282+01:00","updated_at":"2026-01-02T17:14:59.465234+01:00","closed_at":"2026-01-02T17:14:59.465234+01:00","labels":["backend","discovery","opencode"],"dependencies":[{"issue_id":"opencode-squads-via","depends_on_id":"opencode-squads-oz5","type":"blocks","created_at":"2026-01-02T10:10:20.417969+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-vnb","title":"Wire MCP enable/disable and status sync","description":"Reference: docs/prd-mcp-agents.md (Implementation Plan: Phase 3 and Status Sync).\n\nExtend Squads.MCP context with orchestration functions that combine DB and CLI. Add enable_server/2 and disable_server/2 that persist enablement for a squad and call DockerCLI when available. Add sync_status/1 that uses docker mcp server ls to update status and last_error. Add sync_tools/1 to refresh tool metadata. Avoid disabling a server globally if another squad still needs it; if that is not feasible, document the limitation.","acceptance_criteria":"- Enabling a server updates DB and calls DockerCLI.\n- Disabling updates DB and handles CLI errors.\n- Status sync updates status and last_error fields.\n- Clear error returned when docker mcp is unavailable.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T21:48:41.894297+01:00","updated_at":"2026-01-02T21:48:41.894297+01:00"}
{"id":"opencode-squads-vta","title":"Agent chat UI refreshes entire page on message fetch","description":"The agent chat UI currently triggers a full page refresh when fetching new messages. Refactor to use React Query or standard fetch to update messages without reloading the page.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-01T12:25:24.02188+01:00","updated_at":"2026-01-01T13:10:05.59132+01:00","closed_at":"2026-01-01T13:10:05.591322+01:00"}
{"id":"opencode-squads-w37","title":"Backend foundation + project config","description":"Phoenix app, SQLite, core schemas, .squads/config.json, agent naming generator, Vite asset pipeline + dev bind","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-31T11:16:13.268837+01:00","updated_at":"2025-12-31T13:33:24.070253+01:00","closed_at":"2025-12-31T13:33:24.070253+01:00"}
{"id":"opencode-squads-w37.10","title":"Bind dev servers to 0.0.0.0 (Phoenix + Vite)","description":"Configure Phoenix and Vite dev servers to bind 0.0.0.0 for LAN access","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:29:18.519653+01:00","updated_at":"2025-12-31T12:04:40.915012+01:00","closed_at":"2025-12-31T12:04:40.915012+01:00","dependencies":[{"issue_id":"opencode-squads-w37.10","depends_on_id":"opencode-squads-w37","type":"parent-child","created_at":"2025-12-31T11:29:18.520145+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-w37.10","depends_on_id":"opencode-squads-w37.3","type":"blocks","created_at":"2025-12-31T11:31:14.674638+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-w37.3","title":"Scaffold Phoenix app + SQLite config","description":"Create Phoenix project, configure SQLite for dev/test, baseline app structure","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T11:18:28.556736+01:00","updated_at":"2025-12-31T11:48:47.929548+01:00","closed_at":"2025-12-31T11:48:47.929548+01:00","dependencies":[{"issue_id":"opencode-squads-w37.3","depends_on_id":"opencode-squads-w37","type":"parent-child","created_at":"2025-12-31T11:18:28.557197+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-w37.4","title":"Define core schemas: Project, Squad, Agent, Session, Event","description":"Ecto schemas and migrations for core entities and event log","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T11:18:33.74191+01:00","updated_at":"2025-12-31T11:59:41.796673+01:00","closed_at":"2025-12-31T11:59:41.796673+01:00","dependencies":[{"issue_id":"opencode-squads-w37.4","depends_on_id":"opencode-squads-w37","type":"parent-child","created_at":"2025-12-31T11:18:33.742949+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-w37.4","depends_on_id":"opencode-squads-w37.3","type":"blocks","created_at":"2025-12-31T11:30:38.506925+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-w37.5","title":"Implement .squads/config.json schema + validation","description":"Define JSON schema, validation, and load/save helpers","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:18:38.929583+01:00","updated_at":"2025-12-31T12:02:52.486918+01:00","closed_at":"2025-12-31T12:02:52.486918+01:00","dependencies":[{"issue_id":"opencode-squads-w37.5","depends_on_id":"opencode-squads-w37","type":"parent-child","created_at":"2025-12-31T11:18:38.930043+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-w37.5","depends_on_id":"opencode-squads-w37.3","type":"blocks","created_at":"2025-12-31T11:30:43.678551+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-w37.6","title":"Bootstrap project init to create .squads/","description":"Init flow creates .squads directory and default config.json","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:18:44.122142+01:00","updated_at":"2025-12-31T12:06:20.976224+01:00","closed_at":"2025-12-31T12:06:20.976224+01:00","dependencies":[{"issue_id":"opencode-squads-w37.6","depends_on_id":"opencode-squads-w37","type":"parent-child","created_at":"2025-12-31T11:18:44.122662+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-w37.6","depends_on_id":"opencode-squads-w37.5","type":"blocks","created_at":"2025-12-31T11:30:48.838126+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-w37.7","title":"Implement agent naming generator (100x100 lists) + slugging","description":"Curated adjective/noun lists, CamelCase names, slug derivation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:18:49.302547+01:00","updated_at":"2025-12-31T12:04:19.612078+01:00","closed_at":"2025-12-31T12:04:19.612078+01:00","dependencies":[{"issue_id":"opencode-squads-w37.7","depends_on_id":"opencode-squads-w37","type":"parent-child","created_at":"2025-12-31T11:18:49.303028+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-w37.7","depends_on_id":"opencode-squads-w37.3","type":"blocks","created_at":"2025-12-31T11:30:54.009936+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-w37.8","title":"Add base API endpoints for project/squad metadata","description":"REST endpoints to read project and squad config for UI","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T11:18:54.489903+01:00","updated_at":"2025-12-31T12:08:26.586738+01:00","closed_at":"2025-12-31T12:08:26.586738+01:00","dependencies":[{"issue_id":"opencode-squads-w37.8","depends_on_id":"opencode-squads-w37","type":"parent-child","created_at":"2025-12-31T11:18:54.490641+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-w37.8","depends_on_id":"opencode-squads-w37.4","type":"blocks","created_at":"2025-12-31T11:30:59.179436+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-w37.8","depends_on_id":"opencode-squads-w37.5","type":"blocks","created_at":"2025-12-31T11:31:04.337853+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-w37.9","title":"Configure Phoenix assets to use Vite (disable esbuild)","description":"Replace esbuild pipeline with Vite integration for assets","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T11:29:13.338189+01:00","updated_at":"2025-12-31T12:02:22.940386+01:00","closed_at":"2025-12-31T12:02:22.940386+01:00","dependencies":[{"issue_id":"opencode-squads-w37.9","depends_on_id":"opencode-squads-w37","type":"parent-child","created_at":"2025-12-31T11:29:13.338711+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-w37.9","depends_on_id":"opencode-squads-w37.3","type":"blocks","created_at":"2025-12-31T11:31:09.498844+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-wgd","title":"Add Docker MCP CLI wrapper","description":"Reference: docs/prd-mcp-agents.md (Implementation Plan: Phase 3, Docker CLI integration).\n\nAdd Squads.MCP.DockerCLI module to wrap docker mcp commands. Implement functions: catalog_show/0, server_enable/1, server_disable/1, server_ls/0, server_inspect/1, oauth_authorize/1, oauth_ls/0, oauth_revoke/1, tools_ls/0. Use System.cmd/3 and map stdout and stderr to {:ok, data} or {:error, reason}. Allow CLI path override via config with default \"docker\".","acceptance_criteria":"- CLI wrapper exists with functions listed.\n- Errors are normalized and include stderr output.\n- CLI path is configurable via application env.\n- Unit tests stub command execution.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T21:48:36.740615+01:00","updated_at":"2026-01-02T21:48:36.740615+01:00"}
{"id":"opencode-squads-xnl","title":"Fix failing test suite (41 failures)","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T19:30:30.506424+01:00","updated_at":"2025-12-31T19:42:11.578734+01:00","closed_at":"2025-12-31T19:42:11.578734+01:00"}
{"id":"opencode-squads-xo1","title":"Sticky plan/build mode toggle for session chat","description":"Add a plan/build toggle for session chat; default to plan and keep selection sticky per session during the runtime. Send prompts with agent=plan|build and show response mode when present.","acceptance_criteria":"Default mode is plan; switching to build persists for the active session until changed; prompts include agent field; mode label renders when provided.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-01T13:56:16.858468+01:00","updated_at":"2026-01-01T14:42:19.035648+01:00","closed_at":"2026-01-01T14:42:19.035648+01:00"}
{"id":"opencode-squads-xw1","title":"OpenCode chat output polish","description":"","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-01T12:26:38.120529+01:00","updated_at":"2026-01-01T13:11:18.432418+01:00","closed_at":"2026-01-01T13:11:18.432418+01:00","dependencies":[{"issue_id":"opencode-squads-xw1","depends_on_id":"opencode-squads-72z","type":"blocks","created_at":"2026-01-01T12:27:27.797657+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-xw1","depends_on_id":"opencode-squads-n9d","type":"blocks","created_at":"2026-01-01T12:27:36.856849+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-xw1","depends_on_id":"opencode-squads-hwk","type":"blocks","created_at":"2026-01-01T12:27:46.39339+01:00","created_by":"simonthornqvist"},{"issue_id":"opencode-squads-xw1","depends_on_id":"opencode-squads-nrt","type":"blocks","created_at":"2026-01-01T12:35:46.227781+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-xx8","title":"Remove duplicate Squads.Sessions module file from repo root","description":"Problem:\n- sessions_old.ex at repo root defines Squads.Sessions, duplicating lib/squads/sessions.ex.\n- It is not compiled today but confuses tooling and future maintainers.\n\nTask:\n- Decide whether to keep as history; if yes move it to history/ with a clear header note.\n- Otherwise delete the file.\n\nContext:\n- sessions_old.ex\n- lib/squads/sessions.ex","acceptance_criteria":"- Only one file defines defmodule Squads.Sessions.\n- Ripgrep for defmodule Squads.Sessions returns a single file.","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-01T20:56:56.944682+01:00","updated_at":"2026-01-01T21:07:07.407677+01:00","closed_at":"2026-01-01T21:07:07.407677+01:00"}
{"id":"opencode-squads-y5e","title":"Dev console: fix 'Expected a JavaScript-or-Wasm module script' errors","description":"Problem\n- While loading the app in dev mode (:4000), browser console logs repeated errors:\n  - Failed to load module script: Expected a JavaScript-or-Wasm module script but the server responded with ...\n\nImpact\n- Undermines trust during UX testing and may correlate with broken/disabled features depending on what fails to load.\n\nWork\n- Identify which module import/script URL is failing and why it returns the wrong content-type/response (often HTML/404).\n- Fix asset/build/devtools wiring so module scripts always resolve correctly in dev.\n","acceptance_criteria":"- Loading :4000 in dev mode produces no module-script load errors.\n- Devtools warnings/errors are either resolved or explicitly explained (expected) in dev only.\n","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-02T17:57:49.156135+01:00","updated_at":"2026-01-02T19:42:36.329712+01:00","closed_at":"2026-01-02T19:42:36.329712+01:00","labels":["assets","frontend","reliability"],"dependencies":[{"issue_id":"opencode-squads-y5e","depends_on_id":"opencode-squads-5lo","type":"discovered-from","created_at":"2026-01-02T17:57:49.157743+01:00","created_by":"simonthornqvist"}]}
{"id":"opencode-squads-z6z","title":"Frontend audit: fix assets review findings","description":"Context\n- Performed a frontend codebase review under assets/ (Vite + React + TanStack Router/Query).\n- This epic tracks concrete fixes discovered during the review (correctness first, then consistency/cleanup).\n\nScope\n- assets/src/api/*\n- assets/src/routes/*\n- assets/src/components/*\n- Realtime (SSE + WS) invalidation and board/session correctness\n","acceptance_criteria":"- All child issues are implemented and closed.\n- Frontend no longer has runtime hook-order errors.\n- Board + agent tabs + realtime updates behave reliably.\n","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-02T17:37:36.048616+01:00","updated_at":"2026-01-05T09:54:27.659524+01:00","closed_at":"2026-01-05T09:54:27.659524+01:00","labels":["assets","audit","frontend"]}
{"id":"opencode-squads-zcp","title":"Implement /mcps/:mcp builtin MCP endpoints","description":"","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-31T21:18:29.694202+01:00","updated_at":"2025-12-31T22:27:56.433961+01:00","closed_at":"2025-12-31T22:27:56.433961+01:00","dependencies":[{"issue_id":"opencode-squads-zcp","depends_on_id":"opencode-squads-gwm","type":"blocks","created_at":"2025-12-31T21:18:29.695429+01:00","created_by":"simonthornqvist"}]}
